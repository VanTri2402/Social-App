(function(g){var window=this;'use strict';var ElH=function(l){var E=new g.sI("und",new g.Fx("Default","und",!0));E.captionTracks=l.captionTracks;return E},elx=function(l){return new g.aF(function(E,e){var d=l.length,C=[];
if(d)for(var x=function(O,M){d--;C[O]=M;d==0&&E(C)},Y=function(O){e(O)},B,q=0;q<l.length;q++)B=l[q],g.Txs(B,g.MW(x,q),Y);
else E(C)})},FQ=function(l){this.C=l},LN=function(){FQ.apply(this,arguments)},ddR=function(){LN.apply(this,arguments)},CI6=function(){LN.apply(this,arguments)},xdD=function(){LN.apply(this,arguments)},Yst=function(){LN.apply(this,arguments)},ud6=function(){LN.apply(this,arguments)},BwN=function(){LN.apply(this,arguments)},qsB=function(){LN.apply(this,arguments)},Ou5=function(){FQ.apply(this,arguments)},MrW=function(){LN.apply(this,arguments)},vl5=function(){LN.apply(this,arguments)},Nwx=function(){LN.apply(this,
arguments)},JnR=function(){LN.apply(this,arguments)},bux=function(){LN.apply(this,arguments)},DdR=function(){LN.apply(this,arguments)},p5u=function(){LN.apply(this,arguments)},Kt_=function(){LN.apply(this,arguments)},UdN=function(){LN.apply(this,arguments)},mdu=function(){LN.apply(this,arguments)},yn5=function(){LN.apply(this,arguments)},trN=function(){LN.apply(this,arguments)},HuK=function(){FQ.apply(this,arguments)},VrR=function(){LN.apply(this,arguments)},olu=function(){LN.apply(this,arguments)},
Anx=function(){LN.apply(this,arguments)},Qbu=function(){LN.apply(this,arguments)},sb5=function(){LN.apply(this,arguments)},aBR=function(){LN.apply(this,arguments)},IBW=function(){LN.apply(this,arguments)},fBB=function(){LN.apply(this,arguments)},PIN=function(){LN.apply(this,arguments)},RlH=function(){FQ.apply(this,arguments)},k4i=function(){FQ.apply(this,arguments)},hlH=function(){FQ.apply(this,arguments)},FtD=function(){LN.apply(this,arguments)},Ltu=function(){LN.apply(this,arguments)},cni=function(){LN.apply(this,
arguments)},iuK=function(){LN.apply(this,arguments)},Zuo=function(){LN.apply(this,arguments)},$di=function(){LN.apply(this,arguments)},TwW=function(){LN.apply(this,arguments)},glD=function(){LN.apply(this,arguments)},Wt5=function(){LN.apply(this,arguments)},jbi=function(){LN.apply(this,arguments)},G4R=function(){LN.apply(this,arguments)},X5D=function(){LN.apply(this,arguments)},Ss6=function(){LN.apply(this,arguments)},zl5=function(){LN.apply(this,arguments)},rnu=function(){LN.apply(this,arguments)},
w5R=function(){LN.apply(this,arguments)},nlx=function(){LN.apply(this,arguments)},lMB=function(){LN.apply(this,arguments)},ErH=function(){LN.apply(this,arguments)},e5N=function(){LN.apply(this,arguments)},dwo=function(){LN.apply(this,arguments)},CKB=function(){LN.apply(this,arguments)},xwi=function(){LN.apply(this,arguments)},YQx=function(){LN.apply(this,arguments)},ueN=function(){LN.apply(this,arguments)},Bcx=function(){LN.apply(this,arguments)},qQx=function(){LN.apply(this,arguments)},OkB=function(){FQ.apply(this,
arguments)},MxR=function(){LN.apply(this,arguments)},vrR=function(){LN.apply(this,arguments)},Nct=function(){LN.apply(this,arguments)},JRx=function(){LN.apply(this,arguments)},bkH=function(){LN.apply(this,arguments)},DwB=function(){LN.apply(this,arguments)},pDx=function(){LN.apply(this,arguments)},KMu=function(){LN.apply(this,arguments)},UwK=function(){LN.apply(this,arguments)},mw5=function(){LN.apply(this,arguments)},yRx=function(){LN.apply(this,arguments)},txx=function(){LN.apply(this,arguments)},
HkN=function(){LN.apply(this,arguments)},VxK=function(){LN.apply(this,arguments)},or5=function(){LN.apply(this,arguments)},ARt=function(){LN.apply(this,arguments)},QFu=function(){LN.apply(this,arguments)},sFt=function(){LN.apply(this,arguments)},aMB=function(){LN.apply(this,arguments)},IMi=function(){LN.apply(this,arguments)},fMx=function(){LN.apply(this,arguments)},PKi=function(){LN.apply(this,arguments)},R5x=function(){LN.apply(this,arguments)},kMt=function(){LN.apply(this,arguments)},h5x=function(){LN.apply(this,
arguments)},FMu=function(){LN.apply(this,arguments)},LMu=function(){LN.apply(this,arguments)},cRK=function(){LN.apply(this,arguments)},ik6=function(){LN.apply(this,arguments)},ZkK=function(){LN.apply(this,arguments)},$wx=function(){LN.apply(this,arguments)},TcH=function(){LN.apply(this,arguments)},grN=function(){LN.apply(this,arguments)},WM6=function(l){l=l.key||l.id;
if(!l)throw Error("Entity key is missing");return l},jFt=function(){if(cP)return cP();
var l={};cP=g.zJ("PersistentEntityStoreDb",{uU:(l.EntityStore={oh:1},l.EntityAssociationStore={oh:2},l),shared:!1,upgrade:function(E,e){e(1)&&g.fU(g.ow(E,"EntityStore",{keyPath:"key"}),"entityType","entityType");e(2)&&(E=g.ow(E,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.fU(E,"byParentEntityKey","parentEntityKey"),g.fU(E,"byChildEntityKey","childEntityKey"))},
version:3});return cP()},GMo=function(l){return g.iW(jFt(),l)},XDW=function(l){return g.iW((0,g.I7i)(),l)},id=function(l){this.token=l},Zk=function(l,E){E=E===void 0?{}:E;
g.$C.call(this,g.f7_[l],Object.assign({},{name:"PESEncoderError",type:l},E));this.type=l;this.level="WARNING";Object.setPrototypeOf(this,Zk.prototype)},SQt=function(l){return new Zk("WRONG_DATA_TYPE",{WR:l})},z5i=function(l){return l instanceof Error?new Zk("UNKNOWN_ENCODE_ERROR",{originalMessage:l.message}):new Zk("UNKNOWN_ENCODE_ERROR")},rRH=function(l){return l instanceof Error?new Zk("UNKNOWN_DECODE_ERROR",{originalMessage:l.message}):new Zk("UNKNOWN_DECODE_ERROR")},wDW=function(l,E){l=l instanceof
Zk?l:E(l);
g.AZ(l);throw l;},nrN=function(){},lso=function(l,E,e){try{return l.G(E,e)}catch(d){wDW(d,z5i)}},E0D=function(l){l=(new TextEncoder).encode(l).subarray(0,16);
var E=new Uint8Array(16);E.set(l);return E},$E=function(l){this.C=l},d0K=function(l){var E=eNo[l];
if(E)return E;g.Qj(new g.$C("Entity model not found.",{entityType:l}))},CD5=function(l,E){this.C=l;
this.V=E;this.G={}},YeH=function(l,E){a:{l=x0N(l.V,E.version);
try{var e=l.V(E.data,E.key);break a}catch(d){wDW(d,rRH)}e=void 0}return e},TO=function(l,E,e){return l.C.objectStore("EntityStore").get(E).then(function(d){if(d){if(e&&d.entityType!==e)throw Error("Incorrect entity type");
return YeH(l,d)}})},gZ=function(l,E,e){return e?(e=e.map(function(d){return TO(l,d,E)}),g.KU.all(e)):l.C.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(E)).then(function(d){return d.map(function(C){return YeH(l,C)})})},jn=function(l,E,e){var d=WM6(E),C=x0N(l.V,1),x=Object.assign({},E);
return l.C.objectStore("EntityStore").get(d).then(function(Y){if(Y){if(Y.entityType!==e)throw Error("Incorrect entity type");x.entityMetadata||(Y=YeH(l,Y),x.entityMetadata=Y.entityMetadata)}}).then(function(){var Y={key:d,
entityType:e,data:lso(C,x,d),version:1};return g.KU.all([g.sP(l.C.objectStore("EntityStore"),Y),uft(l,x,e)])}).then(function(){WP(l,d,e);
return d})},BVB=function(l,E,e){E=E.map(function(d){return jn(l,d,e)});
return g.KU.all(E)},GO=function(l,E,e){if(e==null?0:e.SP){var d=new Set;
return qeW(l,E,d).then(function(){for(var x=[],Y=g.U(d),B=Y.next();!B.done;B=Y.next())x.push(GO(l,B.value));return g.KU.all(x).then(function(){})})}var C=g.z6(E).entityType;
return g.KU.all([l.C.objectStore("EntityStore").delete(E),O5o(l,E)]).then(function(){WP(l,E,C)})},MlD=function(l,E){return g.hF(l.C.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(E)},function(e){return g.KU.all([e.delete(),
O5o(l,e.cursor.primaryKey)]).then(function(){WP(l,e.cursor.primaryKey,E);return g.Rw(e)})})},v0x=function(l,E,e,d){var C=x0N(l.V,1);
return TO(l,E,d).then(function(x){if(x){x=g.dt(x,e);var Y={key:E,entityType:d,data:lso(C,x,E),version:1};return g.KU.all([g.sP(l.C.objectStore("EntityStore"),Y),uft(l,x,d)])}}).then(function(){WP(l,E,d);
return E})},WP=function(l,E,e){var d=l.G[e];
d||(d=new Set,l.G[e]=d);d.add(E)},NVx=function(l,E,e){var d=WM6(E);
e=d0K(e);if(!e)return g.KU.resolve([]);e=new e(E);l=l.C.objectStore("EntityAssociationStore");E=[];e=g.U(e.V());for(var C=e.next();!C.done;C=e.next())E.push(g.sP(l,{parentEntityKey:d,childEntityKey:C.value}));return g.KU.all(E).then(function(x){return x.map(function(Y){return Y[1]})})},O5o=function(l,E){return l.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(E))},uft=function(l,E,e){var d=WM6(E);
return O5o(l,d).then(function(){return NVx(l,E,e)})},qeW=function(l,E,e){if(e.has(E))return g.KU.resolve(void 0);
e.add(E);return J0N(l,E).then(function(d){return l.C.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(E)).then(function(){return d})}).then(function(d){var C=g.KU.resolve(void 0);
d=g.U(d);for(var x=d.next(),Y={};!x.done;Y={PE:void 0},x=d.next())Y.PE=x.value,C=C.then(function(B){return function(){return qeW(l,B.PE,e)}}(Y));
return C}).then(function(){})},J0N=function(l,E){var e=l.C.objectStore("EntityAssociationStore");
return e.index("byParentEntityKey").getAll(IDBKeyRange.only(E)).then(function(d){var C=[];d=g.U(d);for(var x=d.next();!x.done;x=d.next())x=x.value,C.push(e.index("byChildEntityKey").getAll(x.childEntityKey));return g.KU.all(C)}).then(function(d){var C=[];
d=g.U(d);for(var x=d.next();!x.done;x=d.next())x=x.value,x.length===1&&C.push(x[0].childEntityKey);return C})},XQ=function(){},b5o=function(){this.C={};
this.C[0]=new XQ;if(!g.Dp("aes_pes_encoder_killswitch")){var l=this.C;try{var E=g.TZ();var e=E0D(E);var d=new $E(new g.MO(e),new g.vJ(e))}catch(C){throw l=C instanceof Error?new Zk("KEY_CREATION_FAILED",{originalMessage:C.message}):new Zk("KEY_CREATION_FAILED"),g.AZ(l),l;}l[1]=d}},x0N=function(l,E){E=E===void 0?0:E;
l=l.C[E];if(!l)throw E=new Zk("INVALID_ENCODER_VERSION",{WR:E}),g.AZ(E),E;return l},Sn=function(l,E){g.F.call(this);
this.token=l;this.C=E;this.observers=[];l=new g.wr.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.TZ());l.onmessage=this.V.bind(this);this.channel=l},zO=function(l,E,e){var d,C,x,Y;
return g.P(function(B){if(B.V==1)return g.I(B,GMo(l.token),2);if(B.V!=3)return d=B.C,g.I(B,g.Q_(d,["EntityStore","EntityAssociationStore"],E,function(q){C=new CD5(q,l.C);return e(C)}),3);
x=B.C;C&&(Y=C.G,Object.keys(Y).length>0&&(l.channel.postMessage(Y),D05(l,Y)));return B.return(x)})},rZ=function(l,E,e){return zO(l,{mode:"readwrite",
Xo:!0},function(d){return jn(d,E,e)})},pEN=function(l,E){return zO(l,{mode:"readwrite",
Xo:!0},function(e){return BVB(e,E,"offlineOrchestrationActionWrapperEntity")})},K4H=function(l,E){return zO(l,{mode:"readwrite",
Xo:!0},function(e){return GO(e,E)})},U06=function(l){return zO(l,{mode:"readwrite",
Xo:!0},function(E){return MlD(E,"videoPlaybackPositionEntity")})},wZ=function(l,E,e){return zO(l,{mode:"readonly",
Xo:!0},function(d){return TO(d,E,e)})},nN=function(l,E,e){return zO(l,{mode:"readonly",
Xo:!0},function(d){return gZ(d,E,e)})},D05=function(l,E){l=g.U(l.observers);
for(var e=l.next();!e.done;e=l.next())e=e.value,e(E)},m0t=function(){var l,E,e;
return g.P(function(d){if(d.V==1)return g.o1(d,2),g.I(d,g.Xb(),4);if(d.V!=2){l=d.C;if(!l||!g.gC()||typeof g.wr.BroadcastChannel==="undefined")return d.return();E=new b5o;return d.return(new Sn(l,E))}e=g.I1(d);e instanceof Error&&g.AZ(e);return d.return()})},l6=function(){y0D||(y0D=m0t());
return y0D},tlx=function(l){var E;
l=(E=l.options)==null?void 0:E.persistenceOption;return l==="ENTITY_PERSISTENCE_OPTION_PERSIST"||l==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},H5_=function(l){var E;
return g.P(function(e){return e.V==1?g.I(e,l6(),2):(E=e.C)?g.I(e,zO(E,"readwrite",function(d){for(var C={},x=g.U(l),Y=x.next(),B={};!Y.done;B={ZW:void 0,dH:void 0},Y=x.next())B.ZW=Y.value,B.ZW.entityKey&&tlx(B.ZW)&&(B.dH=g.C7(B.ZW.payload),Y=void 0,B.ZW.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(Y=function(q){return function(){return jn(d,q.ZW.payload[q.dH],q.dH)}}(B)),B.ZW.type==="ENTITY_MUTATION_TYPE_DELETE"&&(Y=function(q){return function(){return GO(d,q.ZW.entityKey)}}(B)),B.ZW.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(Y=function(q){return function(){return v0x(d,q.ZW.entityKey,q.ZW.payload[q.dH],q.dH)}}(B)),Y&&(C[B.ZW.entityKey]=C[B.ZW.entityKey]?C[B.ZW.entityKey].then(Y):Y()));
return g.KU.all(Object.values(C))}),0):e.return()})},VlB=function(l){var E;
return g.P(function(e){if(e.V==1){E=l.mutations;if(!E||E.length<=0)return e.return();if(g.sD){var d={type:"ENTITY_LOADED"};E!==void 0&&(d.payload=E);g.sD.dispatch(d)}return g.I(e,H5_(E),2)}E.length=0;g.Vg(e)})},o0H=function(l){return l!==void 0},A0x=function(l){var E=g.C0();
E=Object.assign({},E);l=Object.assign({},l);for(var e in E)l[e]?(E[e]!==4&&(E[e]=l[e]),delete l[e]):E[e]!==2&&(E[e]=4);Object.assign(E,l);g.kNg(E);JSON.stringify(E);return E},Qa_=function(l){var E,e;
return g.P(function(d){if(d.V==1)return g.I(d,g.Xb(),2);if(d.V!=3)return(E=d.C)?g.I(d,g.us(E),3):d.return();e=d.C;return d.return(g.Q_(e,["index","media","captions"],{mode:"readwrite",Xo:!0},function(C){var x=IDBKeyRange.bound(l+"|",l+"~");C=[C.objectStore("index").delete(x),C.objectStore("media").delete(x),C.objectStore("captions").delete(x)];return g.KU.all(C).then(function(){})}))})},saH=function(){var l,E;
return g.P(function(e){if(e.V==1)return g.I(e,g.Xb(),2);if(e.V!=3){l=e.C;if(!l)throw g.Dh("rvdfd");return g.I(e,g.us(l),3)}E=e.C;return e.return(g.Q_(E,["index","media"],{mode:"readwrite",Xo:!0},function(d){var C={};return g.PS(d.objectStore("index"),{},function(x){var Y=x.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),B=g.KU.resolve(void 0);if(Y){var q=Y[1];Y=Y[2];C[q]=C[q]||{};var O;C[q][Y]=g.icr((O=x.getValue())==null?void 0:O.fmts)}else B=x.delete().then(function(){});
return g.KU.all([g.Rw(x),B]).then(function(M){return g.U(M).next().value})}).then(function(){for(var x={},Y=g.U(Object.keys(C)),B=Y.next();!B.done;B=Y.next()){B=B.value;
var q=C[B].v;x[B]=C[B].a&&q?1:2}var O=A0x(x);return g.HAs(d.objectStore("media"),{},function(M){var v=M.cursor.key.match(g.gbR);v&&x[v[1]]||d.objectStore("media").delete(M.cursor.key);return g.JWo(M)}).then(function(){return O})})}))})},as6=function(l,E){var e,d;
return g.P(function(C){if(C.V==1)return g.I(C,g.Xb(),2);if(C.V!=3){e=C.C;if(!e)throw g.Dh("wct");return g.I(C,g.us(e),3)}d=C.C;return g.I(C,g.Q_(d,["captions"],{mode:"readwrite",Xo:!0},function(x){var Y=[];x=x.objectStore("captions");for(var B=0;B<E.length;B++){var q=g.sP(x,E[B],l+"|"+E[B].metadata.vss_id);Y.push(q)}return g.KU.all(Y)}),0)})},Is5=function(l){var E,e,d;
return g.P(function(C){if(C.V==1)return E=IDBKeyRange.bound(l+"|",l+"~"),g.I(C,g.Xb(),2);if(C.V!=3){e=C.C;if(!e)throw g.Dh("gactfv");return g.I(C,g.us(e),3)}d=C.C;return C.return(d.getAll("captions",E))})},fsu=function(l){return g.P(function(E){g.YX(l,0);
return E.return(Qa_(l))})},PDW=function(l){return{context:g.Sm(),
videoIds:l}},RNK=function(l){return{context:g.Sm(),
playlistIds:l}},klK=function(l){return{context:g.Sm(),
offlinePlaylistSyncChecks:l}},hNo=function(){this.C=new Map},L46=function(){F4K||(F4K=new hNo);
return F4K},c0K=function(l,E){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:l},metadata:E,statusCode:void 0,csn:void 0,can:void 0}},i5D=function(l,E,e){if(!e){var d=d===void 0?!1:d;
e=l.C.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!e||d)e=g.bT(16),l.C.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",e)}l={flowNonce:e,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:E.eventType};E.metadata&&(l.flowMetadata=E.metadata);E.statusCode!==void 0&&(l.flowEventStatus=E.statusCode);E.csn&&(l.csn=E.csn);E.can&&(l.can=E.can);g.CU("flowEvent",l,void 0)},Z5N=function(l){var E,e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn;
return g.P(function(ki){if(ki.V==1)return g.I(ki,zO(l,{mode:"readonly",Xo:!0},function(dr){return gZ(dr,"playbackData").then(function(AH){var y=AH.map(function($i){return $i.transfer}).filter(function($i){return!!$i}),EZ=AH.map(function($i){return $i.offlineVideoPolicy}).filter(function($i){return!!$i}),sp=AH.filter(function($i){return!!$i.key}).map(function($i){return g.rt(g.z6($i.key).entityId,"downloadStatusEntity")});
y=gZ(dr,"transfer",y);EZ=gZ(dr,"offlineVideoPolicy",EZ);sp=gZ(dr,"downloadStatusEntity",sp);var OK=y.then(function($i){$i=$i.reduce(function(jR,eB){(eB==null?0:eB.offlineVideoStreams)&&jR.push.apply(jR,g.bZ(eB.offlineVideoStreams));return jR},[]).filter(function(jR){return!!jR});
return gZ(dr,"offlineVideoStreams",$i)});
return g.KU.all([y,EZ,OK,sp]).then(function($i){var jR=g.U($i);$i=jR.next().value;var eB=jR.next().value;var Cy=jR.next().value;jR=jR.next().value;return[AH,$i,eB,Cy,jR]})})}),2);
if(ki.V!=3)return E=ki.C,g.I(ki,zO(l,{mode:"readonly",Xo:!0},function(dr){return gZ(dr,"mainDownloadsListEntity").then(function(AH){var y,EZ;return(EZ=(y=AH[0])==null?void 0:y.downloads)!=null?EZ:[]})}),3);
e=ki.C;d=g.U(E);C=d.next().value;x=d.next().value;Y=d.next().value;B=d.next().value;q=d.next().value;O=C;M=x;v=Y;N=B;J=q;b={};m={};H={};Q={};A={};f=[];h=g.U(M);for(Z=h.next();!Z.done;Z=h.next())(r=Z.value)&&(b[r.key]=r);X=g.U(v);for(qo=X.next();!qo.done;qo=X.next())(BB=qo.value)&&(m[BB.key]=BB);OZ=g.U(J);for(No=OZ.next();!No.done;No=OZ.next())(eR=No.value)&&(H[eR.key]=eR);fs=g.U(N);for(SR=fs.next();!SR.done;SR=fs.next())(l_=SR.value)&&(Q[l_.key]=l_);po=g.U(e);for(B6=po.next();!B6.done;B6=po.next())R1=
B6.value,B9=void 0,A[(B9=R1.videoItem)!=null?B9:""]=!0,R1.videoItem&&(jB=c6=void 0,qh=(jB=(c6=g.z6(R1.videoItem))==null?void 0:c6.entityId)!=null?jB:"",f.push({externalVideoId:qh}));a=O.filter(function(dr){if(!dr||!dr.key||!dr.offlineVideoPolicy)return!1;dr=g.z6(dr.key).entityId;dr=g.rt(dr,"downloadStatusEntity");var AH;return!(dr&&((AH=H[dr])==null?void 0:AH.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
gn=a.map(function(dr){var AH=b[dr.transfer],y=[];if(AH==null?0:AH.offlineVideoStreams)for(var EZ=g.U(AH.offlineVideoStreams),sp=EZ.next();!sp.done;sp=EZ.next())(sp=Q[sp.value])&&y.push(sp);EZ=m[dr.offlineVideoPolicy];sp=A;var OK=dr==null?void 0:dr.playerResponseTimestamp,$i=g.z6(EZ.key).entityId;dr=g.rt($i,"mainVideoEntity");if(EZ.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var jR="OFFLINE_VIDEO_STATE_DISABLED";EZ.expirationTimestamp&&Number(EZ.expirationTimestamp)<Date.now()/1E3&&(jR="OFFLINE_VIDEO_STATE_EXPIRED")}else if(EZ.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")jR="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(AH==null?void 0:AH.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":jR="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":jR="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":jR="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":jR="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":jR="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":jR="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:jR="OFFLINE_VIDEO_STATE_UNKNOWN"}if(jR==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(AH==null?void 0:AH.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":jR="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":jR="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":jR=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}$i={id:$i,videoState:jR};if(AH==null?0:AH.cotn)$i.cotn=AH.cotn;if(AH==null?0:AH.maximumDownloadQuality)$i.selectedVideoQuality=AH==null?void 0:AH.maximumDownloadQuality;if(AH==null?0:AH.lastProgressTimeMs)$i.lastProgressTimeMs=AH.lastProgressTimeMs;OK&&($i.playerResponseSavedTimeMs=String(Number(OK)*1E3));AH=String;OK=0;y=g.U(y);for(jR=y.next();!jR.done;jR=y.next())if(jR=jR.value,jR.streamsProgress){jR=g.U(jR.streamsProgress);for(var eB=jR.next();!eB.done;eB=jR.next()){var Cy=
void 0;OK+=Number((Cy=eB.value.numBytesDownloaded)!=null?Cy:0)}}$i.downloadedBytes=AH(OK);$i.selectedOfflineMode=sp[dr]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";EZ.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&($i.offlinePlaybackDisabledReason=EZ.offlinePlaybackDisabledReason);return $i});
return ki.return({offlineVideos:gn,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:f}}})})},$0K=function(){this.locks=navigator.locks},TVD=function(){try{var l=g.Eu("ytglobal.locks_");
if(l)return l;var E;if(E=navigator){var e=navigator;E="locks"in e&&!!e.locks}if(E)return g.wr.localStorage&&g.wr.localStorage.getItem("noop"),l=new $0K,g.ns("ytglobal.locks_",l),l}catch(d){}},EF=function(){},g0D=function(){},W4B=function(l){if(l.includes(":"))throw Error("Invalid user cache name: "+l);
return l+":"+g.TZ("CacheStorage get")},jax=function(){return g.P(function(l){if(ej!==void 0)return l.return(ej);
ej=new Promise(function(E){var e;return g.P(function(d){switch(d.V){case 1:return g.o1(d,2),g.I(d,di.open("test-only"),4);case 4:return g.I(d,di.delete("test-only"),5);case 5:g.sZ(d,3);break;case 2:if(e=g.I1(d),e instanceof Error&&e.name==="SecurityError")return E(!1),d.return();case 3:E("caches"in window),g.Vg(d)}})});
return l.return(ej)})},XEK=function(){return g.P(function(l){if(l.V==1)return g.I(l,jax(),2);
if(!l.C)return l.return(void 0);Glo||(Glo=new g0D);return l.return(Glo)})},Cz=function(l,E,e){g.Qj(new g.$C("Woffle: "+l,e?{cotn:e}:""));
E instanceof Error&&g.Qj(E)},Sex=function(l){var E;
return g.P(function(e){if(e.V==1)return g.I(e,Z5N(l),2);E=e.C;g.CU("offlineStateSnapshot",E);g.Vg(e)})},xf=function(l){g.F.call(this);
var E=this;this.api=l;this.qj={OIV:function(){return E.C},
wc4:function(){return E.V}};
typeof g.wr.BroadcastChannel!=="undefined"&&(this.C=new g.wr.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.TZ()),this.C.onmessage=this.G.bind(this),this.V=new g.wr.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.TZ()),this.V.onmessage=this.W.bind(this))},Yf=function(l,E){l.api.x8("onOfflineOperationFailure",E);
var e;(e=l.C)==null||e.postMessage(E)},zNK=function(l,E,e){var d=this;
this.K=l;this.U=E;this.visibility=e;this.Z=this.Y=this.X=this.G=this.C=!1;this.W=new g.Gv(function(){d.b7()});
this.qj={SI:function(){return d.V},
b7:function(){d.b7()},
EkJ:function(){return d.W}};
this.visibility.subscribe("visibilitystatechange",function(){d.N7()})},r0i=function(l){if(!l.G&&!l.C){var E=TVD();
if(E){l.G=!0;var e=g.TZ("OfflineLockManager");E.request("woffle_orchestration_leader:"+e,{},function(){var d,C;return g.P(function(x){switch(x.V){case 1:return g.o1(x,2),l.V=new g.N0,l.C=!0,l.G=!1,g.I(x,l.K(),4);case 4:return g.I(x,l.V.promise,5);case 5:g.sZ(x,0);break;case 2:d=g.I1(x),l.b7(),d instanceof Error&&(C=d,C.args=[{name:"WoLockManagerError",Vl:d.name}],g.AZ(C)),g.Vg(x)}})})}}},wEt=function(l){l.C&&(l.Z=!0,u6(l))},n0_=function(l,E){l.C&&(l.X=E,u6(l))},lIK=function(l,E){l.C&&(l.Y=E,u6(l))},
u6=function(l){l.Y&&l.X&&l.Z&&l.visibility.isBackground()?g.X7(l.W,6E4):l.W.stop()},Bm=function(l){var E;
l.offlineDeleteReason=(E=l.offlineDeleteReason)!=null?E:"OFFLINE_DELETE_REASON_UNKNOWN";var e;l.offlineModeType=(e=l.offlineModeType)!=null?e:"OFFLINE_NOW";g.CU("offlineDeleteEvent",l)},qb=function(l,E){var e=E.videoId;
var d=E.fq;E=E.offlineModeType;l.encryptedVideoId=e;l.cotn=d==null?void 0:d.cotn;l.offlineabilityFormatType=d==null?void 0:d.maximumDownloadQuality;var C;l.isRefresh=(C=d==null?void 0:d.isRefresh)!=null?C:!1;var x;l.softErrorCount=(x=d==null?void 0:d.transferRetryCount)!=null?x:0;l.offlineModeType=E!=null?E:"OFFLINE_NOW";(l.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&l.statusType==="UNKNOWN_STATUS_TYPE"||!l.transferStatusType&&!l.statusType)&&g.Qj(Error("Woffle unknown transfer status"));
g.CU("offlineTransferStatusChanged",l)},E2B=function(l){qb({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",
statusType:"ADDED_TO_QUEUE"},l)},esx=function(l,E,e,d){d={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!d};E&&e&&(E=Math.floor(E/1024).toFixed(),e=Math.floor(e/1024).toFixed(),d.alreadyDownloadedKbytes=E,d.totalFetchedKbytes=E,d.totalContentKbytes=e);qb(d,l)},dtx=function(l){qb({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},l)},CSx=function(l){qb({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},l)},xtt=function(l){switch(l){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
OF=function(l){var E,e,d;
return((d=(E=l.actionMetadata)==null?void 0:(e=E.retryScheduleIntervalsInSeconds)==null?void 0:e.length)!=null?d:0)>0},Mb=function(l){return l.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!l.entityKey},vm=function(l){return l.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!l.entityKey},Nb=function(l){return l.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!l.entityKey},Ynt=function(l){return l.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!l.entityKey},
J6=function(l,E,e,d,C){C=C===void 0?!1:C;
var x,Y,B,q,O,M;return g.P(function(v){if(v.V==1)return x=g.rt(l,E),Y=g.rt(l,"downloadStatusEntity"),g.I(v,zO(e,{mode:"readonly",Xo:!0},function(N){return g.KU.all([TO(N,x,E),TO(N,Y,"downloadStatusEntity")])}),2);
B=v.C;q=B.length?B[0]:void 0;if(!q)return v.jZ(0);O=u7o;if(M=B.length>1?B[1]:void 0){if(M.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!C)return v.return();M.downloadState=d}else M={key:Y,downloadState:d};g.P2(q,O,M);return g.I(v,zO(e,{mode:"readwrite",Xo:!0},function(N){return g.KU.all([jn(N,q,E),jn(N,M,"downloadStatusEntity")])}),0)})},b6=function(l,E){return l.actionType===E.actionType&&l.entityKey===E.entityKey},Dr=function(l,E){if(l&&l.transferState!=="TRANSFER_STATE_COMPLETE"&&l.transferState!==
"TRANSFER_STATE_FAILED"){var e=g.z6(l.key).entityId;
qb({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:e,fq:l,offlineModeType:E})}},pz=function(l){if(!l||!l.thumbnails)return[];
var E=[];l=g.U(l.thumbnails);for(var e=l.next();!e.done;e=l.next())e=e.value,e.url&&E.push(e.url);return E},BGt=function(l,E,e){e=e===void 0?[]:e;
var d,C,x,Y,B,q,O,M,v,N,J,b,m;return g.P(function(H){if(H.V==1)return e.length?g.I(H,nN(l,E),2):H.return([]);d=H.C;C=new Set;x=g.U(d);for(Y=x.next();!Y.done;Y=x.next())if(B=Y.value,q=B.id||B.key)O=g.z6(q).entityId,C.add(O);M=[];v=g.U(e);for(N=v.next();!N.done;N=v.next())J=N.value,b=J.offlineVideoData,m=void 0,((m=b)==null?0:m.videoId)&&!C.has(b.videoId)&&M.push(J);return H.return(M)})},qnH=function(l,E,e){return new g.UD(l,{cotn:E,
raw_player_response:e,download_media:!0,start:Infinity,disable_watch_next:!0})},OAx=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},Kz=function(l,E,e,d,C,x,Y,B,q,O,M){this.entityType=l;
this.actionId=E;this.action=e;this.parentActionId=d;this.rootActionId=C===void 0?E:C;this.childActionIds=x;this.prereqActionId=Y;this.postreqActionIds=B;this.hasChildActionFailed=O;this.retryScheduleIndex=0;this.C=M||Date.now();this.retryScheduleIndex=q||0},UF=function(l){if(!l.key)throw Error("Entity key is required.");
if(!l.actionProto)throw Error("OfflineOrchestrationAction is required.");var E=g.z6(l.key),e=g.z6(l.actionProto.entityKey);return new Kz(e.entityType,E.entityId,l.actionProto,l.parentActionId,l.rootActionId,l.childActionIds,l.prereqActionId,l.postreqActionIds,l.retryScheduleIndex,l.hasChildActionFailed,Number(l.enqueueTimeSec)*1E3)},mw=function(l){return{key:g.rt(l.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:l.action,parentActionId:l.parentActionId,rootActionId:l.rootActionId,childActionIds:l.childActionIds,prereqActionId:l.prereqActionId,postreqActionIds:l.postreqActionIds,retryScheduleIndex:l.retryScheduleIndex,hasChildActionFailed:l.hasChildActionFailed,enqueueTimeSec:(l.C/1E3).toFixed()}},M5W=function(){var l;
return g.P(function(E){return E.V==1?g.I(E,XEK(),2):(l=E.C)?E.return(l.delete("yt-player-local-img")):E.return(!0)})},ya=function(l){var E,e;
return g.P(function(d){if(d.V==1)return g.I(d,XEK(),2);if(d.V!=3){E=d.C;if(!E)throw Error("Cache API not supported");return l.length?g.I(d,E.open("yt-player-local-img"),3):d.return()}e=d.C;return g.I(d,Promise.all(l.map(function(C){return e.delete(C)})),0)})},t6=function(l){var E,e;
return g.P(function(d){if(d.V==1)return g.I(d,XEK(),2);if(d.V!=3){E=d.C;if(!E)throw Error("Cache API not supported");return l.length?g.I(d,E.open("yt-player-local-img"),3):d.return()}e=d.C;return g.I(d,e.addAll(l),0)})},Hm=function(l,E,e,d,C){var x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9;
return g.P(function(c6){switch(c6.V){case 1:return x=g.rt(l,"mainVideoEntity"),Y=g.rt(l,"ytMainChannelEntity"),B=g.rt(l,"transfer"),q=g.rt(l,"videoDownloadContextEntity"),g.I(c6,zO(E,{mode:"readonly",Xo:!0},function(jB){return g.KU.all([TO(jB,x,"mainVideoEntity"),TO(jB,Y,"ytMainChannelEntity"),TO(jB,B,"transfer"),TO(jB,q,"videoDownloadContextEntity"),gZ(jB,"ytMainChannelEntity"),gZ(jB,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:O=c6.C;M=g.U(O);v=M.next().value;N=M.next().value;J=M.next().value;b=M.next().value;m=M.next().value;H=M.next().value;Q=v;A=N;f=J;h=b;Z=m;r=H;if(!Q&&!A){c6.jZ(3);break}X=Q?pz(Q.thumbnail):[];if(!A){qo=[];c6.jZ(4);break}return g.I(c6,v2N(A,Z),5);case 5:qo=c6.C;case 4:return BB=qo,g.I(c6,ya(X.concat(BB)),3);case 3:OZ=[];No=g.rt(l,"downloadStatusEntity");eR=g.U(r);for(fs=eR.next();!fs.done;fs=eR.next())SR=fs.value,l_=g.z6(SR.key).entityId,po=UF(SR),B6=g.z6(po.action.entityKey).entityId,l_!==l&&
B6!==l||b6(e,SR.actionProto)||OZ.push(SR.key);return g.I(c6,zO(E,{mode:"readwrite",Xo:!0},function(jB){var qh=OZ.map(function(a){return GO(jB,a)});
qh.push(GO(jB,x,{SP:!0}));qh.push(GO(jB,No,{SP:!0}));return g.KU.all(qh)}),7);
case 7:B9=(R1=h)==null?void 0:R1.offlineModeType,C&&(Bm(C),C.offlineModeType&&(B9=C.offlineModeType)),Dr(f,B9),Yf(d,{entityKey:x,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Vg(c6)}})},bAN=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn,ki,dr,AH,y,EZ,sp,OK,$i,jR,eB,Cy,W9,t;
return g.P(function(K){switch(K.V){case 1:return C=g.rt(l,"mainPlaylistEntity"),x=g.rt(l,"ytMainChannelEntity"),g.I(K,zO(E,{mode:"readonly",Xo:!0},function(V){return g.KU.all([TO(V,C,"mainPlaylistEntity"),TO(V,x,"ytMainChannelEntity"),gZ(V,"mainPlaylistEntity"),gZ(V,"mainDownloadsListEntity"),gZ(V,"ytMainChannelEntity"),gZ(V,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Y=K.C;B=g.U(Y);q=B.next().value;O=B.next().value;M=B.next().value;v=B.next().value;N=B.next().value;J=B.next().value;b=q;m=O;H=M;Q=v;A=N;f=J;if(!b&&!m){K.jZ(3);break}h=b?NGu(b):[];if(!m){Z=[];K.jZ(4);break}return g.I(K,v2N(m,A),5);case 5:Z=K.C;case 4:return r=Z,g.I(K,ya(h.concat(r)),3);case 3:X=[];qo=new Map;if(!b){K.jZ(7);break}return g.I(K,JWW(b,H,Q),8);case 8:X=K.C;BB=g.U(X);for(OZ=BB.next();!OZ.done;OZ=BB.next())No=OZ.value,qo.set(No,{videoId:No,playlistId:l,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.I(K,zO(E,{mode:"readonly",Xo:!0},function(V){return g.KU.all([gZ(V,"transfer"),gZ(V,"videoDownloadContextEntity")])}),9);
case 9:eR=K.C;fs=g.U(eR);SR=fs.next().value;l_=fs.next().value;po=SR;B6=l_;R1=g.U(po);for(B9=R1.next();!B9.done;B9=R1.next())c6=B9.value,jB=g.z6(c6.key).entityId,(qh=qo.get(jB))&&c6&&(qh.cotn=c6.cotn);a=g.U(B6);for(gn=a.next();!gn.done;gn=a.next())ki=gn.value,dr=g.z6(ki.key).entityId,(AH=qo.get(dr))&&ki&&(AH.offlineModeType=ki.offlineModeType);case 7:y=[];EZ=g.U(f);for(sp=EZ.next();!sp.done;sp=EZ.next())OK=sp.value,$i=g.z6(OK.key).entityId,jR=UF(OK),$i!==l&&jR.rootActionId!==l||b6(e,OK.actionProto)||
y.push(OK.key);eB=g.rt(l,"mainPlaylistEntity");return g.I(K,zO(E,{mode:"readwrite",Xo:!0},function(V){var R=y.map(function(c){return GO(V,c)});
R.push(GO(V,eB,{SP:!0}));return g.KU.all(R)}),10);
case 10:if(!b){K.jZ(0);break}X.reverse();if(!X){K.jZ(0);break}Cy=g.U(X);W9=Cy.next();case 13:if(W9.done){K.jZ(0);break}t=W9.value;return g.I(K,Hm(t,E,e,d,qo.get(t)),14);case 14:W9=Cy.next(),K.jZ(13)}})},pvW=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N;
return g.P(function(J){if(J.V==1)return C=g.rt("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),x=new Map,g.I(J,zO(l,{mode:"readwrite",Xo:!0},function(b){var m=gZ(b,"transfer"),H=gZ(b,"offlineOrchestrationActionWrapperEntity"),Q=gZ(b,"videoDownloadContextEntity"),A=TO(b,C,"mainDownloadsListEntity");return g.KU.all([m,H,Q,A]).then(function(f){f=g.U(f);var h=f.next().value;var Z=f.next().value;var r=f.next().value;var X=f.next().value;f=DtN.map(function(BB){return MlD(b,BB)});
Z=g.U(Z);for(var qo=Z.next();!qo.done;qo=Z.next())qo=qo.value,b6(E,qo.actionProto)||f.push(GO(b,qo.key,{SP:!0}));X&&(X.downloads=[],f.push(jn(b,X,"mainDownloadsListEntity")));if(r)for(r=g.U(r),X=r.next();!X.done;X=r.next())X=X.value,Z=g.z6(X.key).entityId,Z=g.rt(Z,"transfer"),x.set(Z,X.offlineModeType);return g.KU.all(f).then(function(){return h})})}),2);
Y=J.C;B=g.U(Y);for(q=B.next();!q.done;q=B.next())O=q.value,Dr(O,x.get(O.key)),M=g.z6(O.key).entityId,v={videoId:M,offlineDeleteReason:d,cotn:O.cotn,offlineModeType:x.get(O.key)},Bm(v),N=g.rt(M,"mainVideoEntity"),Yf(e,{entityKey:N,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.I(J,M5W(),0)})},NGu=function(l,E){var e=[];
if(l.thumbnailStyleData){l=g.U(l.thumbnailStyleData);for(var d=l.next();!d.done;d=l.next()){var C=void 0,x=void 0,Y=void 0;e=e.concat(pz((C=d.value)==null?void 0:(x=C.value)==null?void 0:(Y=x.collageThumbnail)==null?void 0:Y.coverThumbnail))}}E=pz(E);return e.concat(E)},JWW=function(l,E,e){var d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB;
return g.P(function(OZ){d=[];C=new Set;if(e.length)for(x=g.U(e),Y=x.next();!Y.done;Y=x.next())if(B=Y.value,q=void 0,(q=B.downloads)==null?0:q.length)for(O=g.U(B.downloads),M=O.next();!M.done;M=O.next())v=M.value,v.videoItem&&(N=g.z6(v.videoItem).entityId,C.add(N));if(l.videos){J=g.U(l.videos);for(b=J.next();!b.done;b=J.next())m=b.value,H=JSON.parse(g.z6(m).entityId),H.videoId&&!C.has(H.videoId)&&d.push(H.videoId);Q=g.U(E);for(A=Q.next();!A.done;A=Q.next())if(f=A.value,f.key!==l.key&&(h=f.videos))for(Z=
g.U(h),r=Z.next();!r.done;r=Z.next())X=r.value,qo=JSON.parse(g.z6(X).entityId),qo.videoId&&(BB=d.indexOf(qo.videoId),BB!==-1&&d.splice(BB,1))}return OZ.return(d)})},v2N=function(l,E){var e,d,C,x,Y,B,q,O;
return g.P(function(M){e=pz(l.avatar);d=g.U(E);for(C=d.next();!C.done;C=d.next())if(x=C.value,x.id!==l.id)for(Y=g.U(pz(x.avatar)),B=Y.next();!B.done;B=Y.next())q=B.value,O=e.indexOf(q),O!==-1&&e.splice(O,1);return M.return(e)})},KHR=function(l){var E;
return g.P(function(e){E=g.T(l.frameworkUpdates,Va);return l.frameworkUpdates&&E?g.I(e,VlB(E),0):e.return()})},mt_=function(l){var E;
if((E=l.onResponseReceivedActions)!=null&&E.length){var e;l=(e=g.T(g.T(l.onResponseReceivedActions[0],Utt),g.o$B))==null?void 0:e.actions;if(l!=null&&l.length)return l}},yWt=function(l){var E,e,d;
return g.P(function(C){if(C.V==1)return l?g.I(C,wZ(l,g.Lb,"mainDownloadsListEntity"),2):C.return([]);E=C.C;return((e=E)==null?0:(d=e.downloads)==null?0:d.length)?C.return(E.downloads.map(function(x){var Y;return(Y=x.videoItem)!=null?Y:""})):C.return([])})},HAo=function(l,E){var e;
return g.P(function(d){return d.V==1?g.I(d,t5W(l,E),2):(e=d.C)?g.I(d,zO(l,{mode:"readwrite",Xo:!0},function(C){var x=[jn(C,e.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];e.mainDownloadsListEntity&&x.push(jn(C,e.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.KU.all(x)}),0):d.jZ(0)})},t5W=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f;
return g.P(function(h){if(h.V==1)return e=g.rt("main_downloads_library_id","mainDownloadsLibraryEntity"),d=g.rt("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.I(h,zO(l,{mode:"readonly",Xo:!0},function(Z){return g.KU.all([TO(Z,e,"mainDownloadsLibraryEntity"),TO(Z,d,"mainDownloadsListEntity")])}),2);
C=h.C;x=g.U(C);Y=x.next().value;B=x.next().value;q=Y;O=B;q||(q={id:e});M=g.U(E);for(v=M.next();!v.done;v=M.next())if(N=v.value,N===g.Lb){if(q.smartDownloadsList)return h.return();q.smartDownloadsList=N}else if(J=g.z6(N).entityType,b={},J==="mainPlaylistEntity"?b.playlistItem=N:J==="mainVideoEntity"&&(b.videoItem=N),!g.Jw(b)){m=void 0;if((m=O)==null?0:m.downloads){H=!1;Q=g.U(O.downloads);for(A=Q.next();!A.done;A=Q.next())if(f=A.value,f.playlistItem===N||f.videoItem===N){H=!0;break}H||O.downloads.push(b)}else O=
{id:d,downloads:[b]};q.downloadsList=d}return h.return({mainDownloadsLibraryEntity:q,mainDownloadsListEntity:O})})},V5D=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H;
return g.P(function(Q){if(Q.V==1)return e=g.rt("main_downloads_library_id","mainDownloadsLibraryEntity"),d=g.rt("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.I(Q,zO(l,{mode:"readonly",Xo:!0},function(A){return g.KU.all([TO(A,e,"mainDownloadsLibraryEntity"),TO(A,d,"mainDownloadsListEntity"),TO(A,g.Lb,"mainDownloadsListEntity")])}),2);
C=Q.C;x=g.U(C);Y=x.next().value;B=x.next().value;q=x.next().value;O=Y;M=B;v=q;if(!O)return Q.jZ(0);if(E===g.Lb&&((N=v)==null?0:N.downloads))v.downloads=[];else if((J=M)==null?0:J.downloads)for(b=g.z6(E).entityType,m=0;m<M.downloads.length;m++)if(H=M.downloads[m],b==="mainVideoEntity"&&H.videoItem===E){M.downloads.splice(m,1);break}else if(b==="mainPlaylistEntity"&&H.playlistItem===E){M.downloads.splice(m,1);break}return g.I(Q,zO(l,{mode:"readwrite",Xo:!0},function(A){var f=[jn(A,O,"mainDownloadsLibraryEntity")];
M&&f.push(jn(A,M,"mainDownloadsListEntity"));v&&f.push(jn(A,v,"mainDownloadsListEntity"));return g.KU.all(f)}),0)})},o9=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N;
return g.P(function(J){if(J.V==1)return e=g.rt(E,"transfer"),d=g.rt(E,"videoDownloadContextEntity"),g.I(J,zO(l,{mode:"readonly",Xo:!0},function(b){return g.KU.all([TO(b,e,"transfer"),TO(b,d,"videoDownloadContextEntity")])}),2);
C=J.C;x=g.U(C);Y=x.next().value;B=x.next().value;q=Y;O=B;N={videoId:E,cotn:(M=q)==null?void 0:M.cotn,offlineModeType:(v=O)==null?void 0:v.offlineModeType};return J.return(N)})},A6=function(l,E,e,d,C){var x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo;
return g.P(function(BB){switch(BB.V){case 1:return x=g.rt(l,"musicTrack"),Y=g.rt(l,"transfer"),g.I(BB,zO(E,{mode:"readonly",Xo:!0},function(OZ){return g.KU.all([TO(OZ,x,"musicTrack"),TO(OZ,Y,"transfer"),gZ(OZ,"musicTrack"),gZ(OZ,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:B=BB.C;q=g.U(B);O=q.next().value;M=q.next().value;v=q.next().value;N=q.next().value;J=O;b=M;m=v;H=N;if(!J){BB.jZ(3);break}return g.I(BB,o2x(J,m),4);case 4:return Q=BB.C,g.I(BB,ya(Q),3);case 3:A=[];f=g.U(H);for(h=f.next();!h.done;h=f.next())Z=h.value,r=g.z6(Z.key).entityId,X=UF(Z),qo=g.z6(X.action.entityKey).entityId,r!==l&&qo!==l||b6(e,Z.actionProto)||A.push(Z.key);return g.I(BB,zO(E,{mode:"readwrite",Xo:!0},function(OZ){var No=A.map(function(eR){return GO(OZ,eR)});
No.push(GO(OZ,x,{SP:!0}));return g.KU.all(No)}),6);
case 6:Dr(b),C&&Bm(C),Yf(d,{entityKey:x,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Vg(BB)}})},Qa=function(l,E,e,d,C){var x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn;
return g.P(function(ki){switch(ki.V){case 1:return x=g.rt(l,E),Y=g.rt("music_downloads_library_id","musicDownloadsLibraryEntity"),g.I(ki,zO(e,{mode:"readonly",Xo:!0},function(dr){return g.KU.all([TO(dr,x,E),TO(dr,Y,"musicDownloadsLibraryEntity"),gZ(dr,E),gZ(dr,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:B=ki.C;q=g.U(B);O=q.next().value;M=q.next().value;v=q.next().value;N=q.next().value;J=O;b=M;m=v;H=N;if(!J){ki.jZ(3);break}return g.I(ki,o2x(J,m),4);case 4:return Q=ki.C,g.I(ki,ya(Q),3);case 3:A=[];f=new Map;if(!J){ki.jZ(6);break}return g.I(ki,AWD(J,m,b),7);case 7:A=ki.C;h=g.U(A);for(Z=h.next();!Z.done;Z=h.next())r=Z.value,X=g.z6(r).entityId,f.set(X,{videoId:X,playlistId:l,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.I(ki,nN(e,"transfer"),8);case 8:for(qo=ki.C,BB=
g.U(qo),OZ=BB.next();!OZ.done;OZ=BB.next())No=OZ.value,eR=g.z6(No.key).entityId,(fs=f.get(eR))&&No&&(fs.cotn=No.cotn);case 6:SR=[];l_=g.U(H);for(po=l_.next();!po.done;po=l_.next())B6=po.value,R1=g.z6(B6.key).entityId,B9=UF(B6),R1!==l&&B9.rootActionId!==l||b6(d,B6.actionProto)||SR.push(B6.key);c6=g.rt(l,E);return g.I(ki,zO(e,{mode:"readwrite",Xo:!0},function(dr){var AH=SR.map(function(y){return GO(dr,y)});
AH.push(GO(dr,c6,{SP:!0}));return g.KU.all(AH)}),9);
case 9:if(!J){ki.jZ(0);break}A.reverse();if(!A.length){ki.jZ(0);break}jB=g.U(A);qh=jB.next();case 12:if(qh.done){ki.jZ(0);break}a=qh.value;gn=g.z6(a).entityId;if(!gn){ki.jZ(13);break}return g.I(ki,A6(gn,e,d,C,f.get(gn)),13);case 13:qh=jB.next(),ki.jZ(12)}})},sF=function(l,E,e){var d,C,x,Y,B,q,O;
return g.P(function(M){if(M.V==1)return g.I(M,zO(l,{mode:"readwrite",Xo:!0},function(v){var N=gZ(v,"transfer"),J=gZ(v,"offlineOrchestrationActionWrapperEntity");return g.KU.all([N,J]).then(function(b){b=g.U(b);var m=b.next().value;var H=b.next().value;b=Qmt.map(function(h){return MlD(v,h)});
H=g.U(H);for(var Q=H.next();!Q.done;Q=H.next()){Q=Q.value;var A=g.z6(Q.actionProto.entityKey).entityType==="musicTrack",f=Q.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";b6(E,Q.actionProto)||A&&(!A||f)||b.push(GO(v,Q.key,{SP:!0}))}return g.KU.all(b).then(function(){return m})})}),2);
d=M.C;C=g.U(d);for(x=C.next();!x.done;x=C.next())Y=x.value,Dr(Y),B=g.z6(Y.key).entityId,q={videoId:B,offlineDeleteReason:void 0,cotn:Y.cotn},Bm(q),O=g.rt(B,"musicTrack"),Yf(e,{entityKey:O,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.I(M,M5W(),0)})},sm_=function(l){for(var E,e=g.U(l.additionalMetadatas),d=e.next();!d.done;d=e.next())d=d.value,d.offlineMusicVideoData&&(E=d.offlineMusicVideoData);
var C,x,Y,B,q;return{id:g.rt(l.videoId,"musicTrack"),videoId:l.videoId,title:l.title,thumbnailDetails:l.thumbnail,lengthMs:String(Number(l.lengthSeconds)*1E3),albumTitle:(C=E)==null?void 0:C.releaseTitle,musicVideoType:(x=E)==null?void 0:x.musicVideoType,contentRating:{explicitType:(Y=E)==null?void 0:Y.explicitType},artistNames:((B=E)==null?void 0:B.byline)||((q=E)==null?void 0:q.channelName),downloadMetadata:g.rt(l.videoId,"musicTrackDownloadMetadataEntity")}},AWD=function(l,E,e){var d,C,x,Y,B,q,
O,M,v,N,J,b,m,H,Q,A,f,h;
return g.P(function(Z){d=[];C=new Set;if((x=e)==null?0:(Y=x.downloadedTracks)==null?0:Y.length)for(B=g.U(e.downloadedTracks),q=B.next();!q.done;q=B.next())O=q.value,C.add(O);if(l.tracks){M=g.U(l.tracks);for(v=M.next();!v.done;v=M.next())N=v.value,C.has(N)||d.push(N);J=g.U(E);for(b=J.next();!b.done;b=J.next())if(m=b.value,m.id!==l.id&&(H=m.tracks))for(Q=g.U(H),A=Q.next();!A.done;A=Q.next())f=A.value,h=d.indexOf(f),h!==-1&&d.splice(h,1)}return Z.return(d)})},o2x=function(l,E){var e,d,C,x,Y,B,q,O;
return g.P(function(M){e=pz(l.thumbnailDetails);d=g.U(E);for(C=d.next();!C.done;C=d.next())if(x=C.value,x.id!==l.id)for(Y=g.U(pz(x.thumbnailDetails)),B=Y.next();!B.done;B=Y.next())q=B.value,O=e.indexOf(q),O!==-1&&e.splice(O,1);return M.return(e)})},aI6=function(l,E){var e,d,C,x,Y,B,q,O,M;
return g.P(function(v){if(v.V==1)return e=g.rt("music_downloads_library_id","musicDownloadsLibraryEntity"),g.I(v,wZ(l,e,"musicDownloadsLibraryEntity"),2);(d=v.C)||(d={id:e});C=g.z6(E).entityType;C==="musicTrack"?(x=d.downloadedTracks)!=null&&x.includes(E)||(d.downloadedTracks=((Y=d.downloadedTracks)!=null?Y:[]).concat(E)):C==="musicPlaylist"?(B=d.downloadedPlaylists)!=null&&B.includes(E)||(d.downloadedPlaylists=((q=d.downloadedPlaylists)!=null?q:[]).concat(E)):C!=="musicAlbumRelease"||(O=d.downloadedAlbumReleases)!=
null&&O.includes(E)||(d.downloadedAlbumReleases=((M=d.downloadedAlbumReleases)!=null?M:[]).concat(E));return g.I(v,rZ(l,d,"musicDownloadsLibraryEntity"),0)})},IIK=function(l,E){var e,d,C,x,Y,B,q;
return g.P(function(O){if(O.V==1)return e=g.rt("music_downloads_library_id","musicDownloadsLibraryEntity"),g.I(O,wZ(l,e,"musicDownloadsLibraryEntity"),2);d=O.C;if(!d)return O.jZ(0);C=g.z6(E).entityType;C==="musicTrack"?x=d.downloadedTracks:C==="musicPlaylist"&&(x=d.downloadedPlaylists);if((Y=x)==null?0:Y.length)for(B=0;B<x.length;B++)if(q=x[B],q===E){x.splice(B,1);break}return g.I(O,rZ(l,d,"musicDownloadsLibraryEntity"),0)})},fIo=function(l){var E=l.videos;
l=[];var e=[];if(E){E=g.U(E);for(var d=E.next();!d.done;d=E.next()){var C=d.value.offlineVideoData.videoId;d=g.rt(C,"musicTrack");C=g.rt(C,"musicTrackDownloadMetadataEntity");l.push(d);e.push(C)}}return{n6:l,Sa:e}},a9=function(l,E,e){E={track:sm_(E)};
e&&(E.playlistId=e);if(l=g.T(l.actionMetadata,PSi))E.maximumDownloadQuality=l.maximumDownloadQuality;return{musicTrackEntityActionMetadata:E}},kvt=function(l){var E,e,d,C,x,Y,B,q;
return g.P(function(O){switch(O.V){case 1:return E=g.jp(),e=PDW(l),d=g.wa(Rs_),g.o1(O,2),x={GH:!0},g.I(O,g.kM(E,e,d,void 0,x),4);case 4:C=O.C;g.sZ(O,3);break;case 2:Y=g.I1(O);if(Y instanceof g.Tg)throw B="GetOffline network manager error: "+Y.message,Cz(B,Y),Error(B);Cz("GetOffline fetch request error",Y);throw Error("GetOffline fetch request error");case 3:q=I9(C);if(!C)throw Cz("Network request failed"),Error("Network request failed");if(q!==void 0)fz(q);else if(!C.videos||!C.videos.length)throw Cz("No data"),
Error("No data");return O.return(C.videos.map(function(M){return M.offlineVideoData}))}})},hsu=function(l){var E,e,d,C,x,Y,B,q;
return g.P(function(O){switch(O.V){case 1:return E=g.jp(),e=RNK(l),d=g.wa(Rs_),g.o1(O,2),x={GH:!0},g.I(O,g.kM(E,e,d,void 0,x),4);case 4:C=O.C;g.sZ(O,3);break;case 2:Y=g.I1(O);if(Y instanceof g.Tg)throw B="GetOffline network manager error for playlist: "+Y.message,Cz(B,Y),Error(B);Cz("GetOffline fetch request error for playlist",Y);throw Error("GetOffline fetch request error for playlist");case 3:q=I9(C);if(!C)throw Cz("Network request failed for playlist"),Error("Network request failed for playlist");
if(q!==void 0)fz(q,"playlist");else if(!C.playlists||!C.playlists.length)throw Cz("No data for playlist"),Error("No data for playlist");return O.return(C.playlists.map(function(M){return M.offlinePlaylistData}))}})},LH5=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6;
return g.P(function(R1){switch(R1.V){case 1:return g.I(R1,l6(),2);case 2:C=R1.C;if(!C)return R1.return([]);x=[];if((Y=d)==null?0:Y.length){x=d;R1.jZ(3);break}return g.I(R1,nN(C,"mainPlaylistEntity"),4);case 4:x=R1.C;case 3:if(!x.length)return R1.return([]);B=[];q=Date.now()/1E3;O=g.U(x);M=O.next();case 5:if(M.done)return B.length?g.I(R1,FHu(B),10):R1.return([]);v=M.value;if(!v.downloadState){N=void 0;R1.jZ(8);break}return g.I(R1,wZ(C,v.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:N=
R1.C;case 8:J=N;b=void 0;H=(m=(b=v)==null?void 0:b.entityMetadata)&&m.nextAutoRefreshIntervalSeconds?Number(m.nextAutoRefreshIntervalSeconds):NaN;Q=Number.isNaN(H)?l:H;f=A=void 0;h=((A=J)==null?0:A.lastSyncedTimestampMillis)?Number((f=J)==null?void 0:f.lastSyncedTimestampMillis)/1E3:0;r=Z=void 0;X=((Z=J)==null?0:Z.addedTimestampMillis)?Number((r=J)==null?void 0:r.addedTimestampMillis)/1E3:0;if(e||!m||h+Q<=q){qo=[];BB=void 0;if((BB=v.videos)==null?0:BB.length)for(OZ=g.U(v.videos),No=OZ.next();!No.done;No=
OZ.next())eR=No.value,fs=JSON.parse(g.z6(eR).entityId),fs.videoId&&qo.push(fs.videoId);SR="0";m&&(l_=void 0,SR=String(Number((l_=m.offlineLastModifiedTimestampSeconds)!=null?l_:0).toFixed()));po={playlistId:v.playlistId,videoIds:qo,offlineLastModifiedTimestamp:SR,autoSync:E,offlineDateAddedTimestamp:String(X.toFixed())};B.push(po)}M=O.next();R1.jZ(5);break;case 10:return B6=R1.C,R1.return(B6)}})},cWx=function(){var l,E,e,d,C;
return g.P(function(x){if(x.V==1)return g.I(x,l6(),2);if(x.V!=3)return(l=x.C)?g.I(x,nN(l,"refresh"),3):x.return(!1);E=x.C;if((e=E[0])==null||!e.refreshTime)return x.return(!1);d=Number(E[0].refreshTime);C=Date.now()/1E3;return x.return(isFinite(d)&&C>=d)})},ZAD=function(l,E){var e,d,C;
return g.P(function(x){switch(x.V){case 1:return g.o1(x,2),g.I(x,iAu(l,E),4);case 4:return d=x.C,g.I(x,KHR(d),5);case 5:e=mt_(d);g.sZ(x,3);break;case 2:C=g.I1(x),Cz("getAndProcessSmartDownloadsResponse request or processing error",C);case 3:return x.return(e)}})},$tt=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6;
return g.P(function(R1){switch(R1.V){case 1:return g.I(R1,l6(),2);case 2:C=R1.C;if(!C)return R1.return([]);x=[];if((Y=d)==null?0:Y.length){x=d;R1.jZ(3);break}return g.I(R1,nN(C,"musicPlaylist"),4);case 4:x=R1.C;case 3:if(!x.length)return R1.return([]);B=[];q=Date.now()/1E3;O=g.U(x);M=O.next();case 5:if(M.done)return B.length?g.I(R1,FHu(B),10):R1.return([]);v=M.value;N=void 0;b=(J=(N=v)==null?void 0:N.entityMetadata)&&J.nextAutoRefreshIntervalSeconds?Number(J.nextAutoRefreshIntervalSeconds):NaN;m=
Number.isNaN(b)?l:b;Q=H=0;A="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!v.downloadMetadata){R1.jZ(8);break}return g.I(R1,wZ(C,v.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:f=R1.C,Z=h=void 0,H=Number((Z=(h=f)==null?void 0:h.addedTimestampMillis)!=null?Z:"0")/1E3,X=r=void 0,Q=Number((X=(r=f)==null?void 0:r.lastModifiedTimestampMillis)!=null?X:"0")/1E3,BB=qo=void 0,A=(BB=(qo=f)==null?void 0:qo.syncState)!=null?BB:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:OZ=void 0;if(e||A!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!J||Number((OZ=J.lastSyncedTimestampSeconds)!=null?OZ:0)+m<=q){No=[];eR=void 0;if((eR=v.tracks)==null?0:eR.length)for(fs=g.U(v.tracks),SR=fs.next();!SR.done;SR=fs.next())l_=SR.value,No.push(g.z6(l_).entityId);po={playlistId:v.playlistId,videoIds:No,offlineLastModifiedTimestamp:String(Q.toFixed()),autoSync:E,offlineDateAddedTimestamp:String(H.toFixed())};B.push(po)}M=O.next();R1.jZ(5);break;case 10:return B6=R1.C,R1.return(B6)}})},iAu=function(l,E){var e,d,C,x,Y,B,q,O,M,v;
return g.P(function(N){switch(N.V){case 1:return e=g.jp(),g.I(N,l6(),2);case 2:d=N.C;if(!d){N.jZ(3);break}return g.I(N,Z5N(d),4);case 4:C=N.C;case 3:var J=C;x={context:g.Sm(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:l},offlineClientState:J,clientStateRequestData:{preferredFormatType:E}}}};Y=g.wa(TGD);g.o1(N,5);q={GH:!0};return g.I(N,g.kM(e,x,Y,void 0,q),7);case 7:B=N.C;g.sZ(N,6);break;case 5:O=g.I1(N);if(O instanceof g.Tg)throw M=
"DPS network manager error for smart downloads: "+O.message,Cz(M,O),Error(M);Cz("DPS fetch request error for smart downloads",O);throw Error("DPS fetch request error for smart downloads");case 6:v=I9(B);if(B)v!==void 0&&fz(v,"smart downloads");else throw Cz("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return N.return(B)}})},WHR=function(l,E){var e,d,C,x,Y,B,q,O;
return g.P(function(M){switch(M.V){case 1:return e=g.jp(),d={context:g.Sm(),videoPlaybackPositionEntities:l,lastSyncTimestampUsec:E},C=g.wa(g2x),g.o1(M,2),Y={GH:!0},g.I(M,g.kM(e,d,C,void 0,Y),4);case 4:x=M.C;g.sZ(M,3);break;case 2:B=g.I1(M);if(B instanceof g.Tg)throw q="VPPS network manager error: "+B.message,Cz(q,B),Error(q);Cz("VPPS fetch request error",B);throw Error("VPPS fetch request error");case 3:O=I9(x);if(x)O!==void 0&&fz(O,"position sync");else throw Cz("Network request failed for position sync"),
Error("Network request failed for position sync");return M.return(x)}})},GvB=function(l,E,e){var d,C,x,Y,B,q,O,M;
return g.P(function(v){switch(v.V){case 1:d=g.jp();var N=e.refreshData,J=e.isEnqueuedForExpiredStreamUrlRefetch,b=e.Zw,m=e.offlineSourceData,H=e.mediaCapabilities,Q={entityKey:l};N&&(Q.refreshData=N);J&&(Q.isExpiredStreamUrlRefetch=J);b&&(Q.downloadParameters=b);m&&(Q.offlineSourceData=m);N={context:g.oy(E),signatureTimestamp:20313,videos:[Q]};H&&(N.mediaCapabilities=H);C=N;x=g.wa(jmD);g.o1(v,2);B={GH:!0};return g.I(v,g.kM(d,C,x,void 0,B),4);case 4:Y=v.C;g.sZ(v,3);break;case 2:q=g.I1(v);if(q instanceof
g.Tg)throw O="GetPDE network manager error: "+q.message,Cz(O,q),Error(O);Cz("GetPDE fetch request error",q);throw Error("GetPDE fetch request error");case 3:M=I9(Y);if(Y)M!==void 0&&fz(M,"PDE");else throw Cz("Network request failed for PDE"),Error("Network request failed for PDE");return v.return(Y)}})},I9=function(l){var E;
return(E=l.errorMetadata)==null?void 0:E.status},fz=function(l,E){E=E?" for "+E:"";
if(l===0)throw l="Empty response body"+E,Cz(l),Error(l);l="Response with error"+E;Cz(l);throw Error(l);},FHu=function(l){var E,e,d,C,x,Y,B,q;
return g.P(function(O){switch(O.V){case 1:return E=g.jp(),e=klK(l),d=g.wa(Xvt),g.o1(O,2),x={GH:!0},g.I(O,g.kM(E,e,d,void 0,x),4);case 4:C=O.C;g.sZ(O,3);break;case 2:Y=g.I1(O);if(Y instanceof g.Tg)throw B="offlinePlaylistSyncCheck network manager error: "+Y.message,Cz(B,Y),Error(B);Cz("offlinePlaylistSyncCheck fetch request error",Y);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:q=I9(C);if(!C)throw Cz("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(q!==void 0)fz(q,"playlist sync");else if(!C.offlinePlaylistSyncCheckDatas||!C.offlinePlaylistSyncCheckDatas.length)throw Cz("No data for playlist sync"),Error("No data for playlist sync");return O.return(C.offlinePlaylistSyncCheckDatas.map(function(M){return M.offlinePlaylistSyncCheckData}))}})},Pm=function(l){this.C=l},Snx=function(l,E){var e,d,C,x,Y,B;
return g.P(function(q){switch(q.V){case 1:e=new Map,d=g.U(E),C=d.next();case 2:if(C.done){q.jZ(4);break}x=C.value;Y=e;B=Y.set;return g.I(q,l.V(x),5);case 5:B.call(Y,x,q.C);C=d.next();q.jZ(2);break;case 4:return q.return(e)}})},R9=function(l,E,e,d,C,x){E=g.rt(E,e);
d=Object.assign({},x,{priority:d,retryScheduleIntervalsInSeconds:C});return{actionType:l,entityKey:E,actionMetadata:d}},kf=function(l,E,e,d,C,x){this.status=l;
this.C=E;this.W=e;this.V=d;this.G=C;this.downloadState=x},zsx=function(l,E,e){this.C=l;
this.Mw=E;this.G=e},n2u=function(l,E){var e,d,C,x,Y,B,q,O,M;
return g.P(function(v){switch(v.V){case 1:return e=E.entityKey,C=(d=g.T(E.actionMetadata,h6))==null?void 0:d.isEnqueuedForExpiredStreamUrlRefetch,g.o1(v,2),x=void 0,g.I(v,rWR(l,E),4);case 4:x=v.C;g.o1(v,5);var N=(N=g.T(E.actionMetadata,h6))?{maximumDownloadQuality:N.maximumDownloadQuality}:void 0;return g.I(v,GvB(e,l.Mw,{isEnqueuedForExpiredStreamUrlRefetch:C,Zw:N,offlineSourceData:x}),7);case 7:Y=v.C;g.sZ(v,6,2);break;case 5:return g.I1(v,2),B=OF(E)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",Cz("PDE handleAdd error"),v.return(FO(E,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",B,"DOWNLOAD_STATE_FAILED"));case 6:return g.I(v,wvD(l,Y,E),8);case 8:return v.return(FO(E,!0,Y.orchestrationActions));case 2:return q=g.I1(v),O="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",M="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",q instanceof g.MH&&q.type==="QUOTA_EXCEEDED"&&(O="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
M="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Cz("PDE handleAdd error"),v.return(FO(E,!1,void 0,O,M,"DOWNLOAD_STATE_FAILED"))}})},eJD=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB;
return g.P(function(OZ){switch(OZ.V){case 1:return e=E.entityKey,d=g.z6(e).entityId,g.I(OZ,zO(l.C,{mode:"readonly",Xo:!0},function(No){var eR=TO(No,e,"playbackData"),fs=TO(No,g.rt(d,"offlineVideoPolicy"),"offlineVideoPolicy");No=TO(No,g.rt(d,"transfer"),"transfer");return g.KU.all([eR,fs,No])}),2);
case 2:C=OZ.C;x=g.U(C);Y=x.next().value;B=x.next().value;q=x.next().value;O=Y;M=B;v=q;if(!O||!M)return OZ.return(FO(E,!0));N=[];m=((b=O)==null?0:b.playerResponseJson)?JSON.parse(O.playerResponseJson):null;if(!(v&&m&&l.Mw.B("html5_refresh_deprecated_downloads"))){OZ.jZ(3);break}J=lox(l,m,v);return g.I(OZ,EPN(l,v),4);case 4:N=OZ.C;case 3:H={lastPlayerResponseTimestampSeconds:O.playerResponseTimestamp,offlineToken:M.offlineToken,formatIds:N};Q={};if((A=v)==null?0:A.maximumDownloadQuality)Q.maximumDownloadQuality=
v.maximumDownloadQuality;g.o1(OZ,5);f=void 0;return g.I(OZ,rWR(l,E),7);case 7:return f=OZ.C,g.o1(OZ,8),g.I(OZ,GvB(e,l.Mw,{refreshData:H,Zw:Q,offlineSourceData:f,mediaCapabilities:J}),10);case 10:h=OZ.C;g.sZ(OZ,9,5);break;case 8:return g.I1(OZ,5),Z=OF(E)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",Cz("PDE handleRefresh error"),OZ.return(FO(E,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",Z,
"DOWNLOAD_STATE_FAILED"));case 9:return g.I(OZ,wvD(l,h,E),11);case 11:return OZ.return(FO(E,!0,h.orchestrationActions));case 5:return r=g.I1(OZ),X="PDE handleRefresh error",r instanceof Error&&(X="PDE handleRefresh error: "+r.message),qo="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",BB="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",r instanceof g.MH&&r.type==="QUOTA_EXCEEDED"&&(qo="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",BB="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
Cz(X),OZ.return(FO(E,!1,void 0,qo,BB,"DOWNLOAD_STATE_FAILED"))}})},rWR=function(l,E){var e,d,C,x;
return g.P(function(Y){if(Y.V==1)return e=g.z6(E.entityKey).entityId,d=g.rt(e,"videoDownloadContextEntity"),g.I(Y,wZ(l.C,d,"videoDownloadContextEntity"),2);C=Y.C;return(x=C)!=null&&x.offlineModeType?Y.return({offlineModeType:C.offlineModeType}):Y.return(void 0)})},wvD=function(l,E,e){var d,C,x,Y,B;
return g.P(function(q){if(q.V==1){if(!E.frameworkUpdates||!g.T(E.frameworkUpdates,Va))return q.return();if(!(g.T(E.frameworkUpdates,Va).mutations&&g.T(E.frameworkUpdates,Va).mutations.length>0&&g.T(E.frameworkUpdates,Va).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return q.jZ(2);d=g.z6(g.T(E.frameworkUpdates,Va).mutations[0].entityKey).entityId;return g.I(q,o9(l.C,d),3)}if(q.V!=2){C=q.C;x=g.T(e.actionMetadata,h6);if(B=(Y=x)==null?void 0:Y.playlistId)C.playlistId=B;C.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.Vr(l.Mw)?g.I(q,Hm(d,l.C,e,l.G,C),2):g.Rn(l.Mw)?g.I(q,A6(d,l.C,e,l.G),2):q.jZ(2)}return g.I(q,VlB(g.T(E.frameworkUpdates,Va)),0)})},FO=function(l,E,e,d,C,x){return new kf(E?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",OF(l),e,d,C,x)},lox=function(l,E,e){E=qnH(l.Mw,e.cotn,E);
e=g.hQ(E);return g.yos(E,e,l.Mw)},EPN=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N;
return g.P(function(J){if(J.V==1)return e=[],g.I(J,zO(l.C,{mode:"readonly",Xo:!0},function(b){var m=[],H=E.offlineVideoStreams;if(H){H=g.U(H);for(var Q=H.next();!Q.done;Q=H.next())m.push(TO(b,Q.value,"offlineVideoStreams"))}return g.KU.all(m)}),2);
if(d=J.C)for(C=g.U(d),x=C.next();!x.done;x=C.next())if(Y=x.value,B=void 0,(B=Y)==null?0:B.streamsProgress)for(q=Y.streamsProgress,O=0;O<q.length;O++)M=q[O],v=JSON.parse(M.formatStreamBytes),N={itag:v.itag,lmt:v.lastModified,xtags:v.xtags},e.push(N);return J.return(e)})},dEi=function(l,E){this.C=l;
this.Mw=E},C9_=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J;
return g.P(function(b){switch(b.V){case 1:return e=OF(E),g.I(b,nN(l.C,"videoPlaybackPositionEntity"),2);case 2:d=b.C;if(d.length===0)return b.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));g.o1(b,3);return g.I(b,id.getInstance(),5);case 5:C=b.C;if(!C)throw Error("prefStorage is undefined");return g.I(b,C.get("psi"),6);case 6:return x=b.C,q=(B=(Y=x)==null?void 0:Y.Zk)!=null?B:"0",g.I(b,WHR(d,q),7);case 7:return O=b.C,M={isPaused:O.watchHistoryPaused,Zk:O.syncTimestampUsec},g.I(b,C.set("psi",
M),8);case 8:if(M.isPaused){b.jZ(9);break}v=g.T(O.frameworkUpdates,Va);if(!O.frameworkUpdates||!v){b.jZ(9);break}return g.I(b,VlB(v),9);case 9:g.sZ(b,4);break;case 3:return N=g.I1(b),J="PPE handleRefresh error: "+(N instanceof Error?N.message:"unknown error"),Cz(J),b.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return b.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},Ydu=function(l,E){var e,d,C,x,Y,B,q,O;
return g.P(function(M){switch(M.V){case 1:return e=OF(E),d=g.z6(E.entityKey).entityId,g.o1(M,2),g.I(M,id.getInstance(),4);case 4:C=M.C;if(!C)throw Error("prefStorage is undefined");return g.I(M,C.get("psi"),5);case 5:x=M.C;Y=g.T(E.actionMetadata,xEu);if(((B=x)==null?void 0:B.isPaused)!==!1||(q=Y)==null||!q.lastPlaybackPositionSeconds){M.jZ(6);break}O={key:g.rt(d,"videoPlaybackPositionEntity"),videoId:d,lastPlaybackPositionSeconds:Y.lastPlaybackPositionSeconds};return g.I(M,rZ(l.C,O,"videoPlaybackPositionEntity"),
6);case 6:g.sZ(M,3);break;case 2:return g.I1(M),M.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return M.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e))}})},uW5=function(l,E){var e,d,C;
return g.P(function(x){switch(x.V){case 1:e=OF(E);g.o1(x,2);d=g.z6(E.entityKey).entityId;if(d==="!*$_ALL_ENTITIES_!*$")return g.I(x,U06(l.C),5);C=g.rt(d,"videoPlaybackPositionEntity");return g.I(x,K4H(l.C,C),5);case 5:g.sZ(x,3);break;case 2:return g.I1(x),x.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return x.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},B4B=function(l,E){this.api=l;
this.C=E;this.logger=new g.VG("woffle");this.V=!1;this.qj={q3:this.q3};this.logger.debug("Initialized OfflineMediaManager")},qdN=function(l){return g.P(function(E){return E.return(fsu(l))})},OZx=function(l){var E;
return g.P(function(e){if(e.V==1)return g.I(e,g.Zcr(l),2);E=e.C;return e.return(E.filter(function(d){return!!d.url}).map(function(d){return d.url}))})},Lz=function(l,E){var e=g.xX(E);
if(e===1||e===0)return Promise.resolve();(e=McN(l,E))&&e.stopVideo();l.G=0;return qdN(E)},cm=function(l,E,e,d){e=e===void 0?!1:e;
d=d===void 0?!0:d;var C=typeof E==="string"?E:E.videoDetails.videoId;g.xX(C)===2&&((E=McN(l,C))?E.stopVideo():l.logger.info(function(){return"Corresponding player for "+C+" not found. Pausing anyway"}),g.YX(C,2),l.G=2,e?vPx(l.C):d&&N4D(l.C))},McN=function(l,E){var e;
return((e=l.player)==null?void 0:e.getVideoData().videoId)===E?l.player:null},JBo=function(l,E,e){E.getPlayerResponse();
g.YX(E.videoId,2);l.G=2;l.V=!1;var d;(d=l.player)==null||d.dispose();l.player=l.api.wv(E);E={};l.player.lR((E.localmediachange=l.Qf,E.signatureexpired=l.Xn,E.statechange=l.Ag4,E),l);l.B("html5_generate_content_po_token")&&l.player.GM();var C=l.q3(e);l.player.eJ(g.IG(C,C,!0,"m"),!1);l.logger.debug(function(){return"Starting headless playback with quality: "+C});
l.player.Bo(!1)},bZu=function(l,E){this.C=l;
this.Mw=E},pNo=function(l,E){var e,d;
return g.P(function(C){switch(C.V){case 1:return e=OF(E),g.I(C,wZ(l.C,E.entityKey,"transfer"),2);case 2:if(d=C.C)return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));g.o1(C,3);return g.I(C,DE_(l,E),5);case 5:g.sZ(C,4);break;case 3:return g.I1(C),C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},KPu=function(l,E){var e,d;
return g.P(function(C){switch(C.V){case 1:return e=OF(E),g.I(C,wZ(l.C,E.entityKey,"transfer"),2);case 2:d=C.C;if(!d||d.transferState!=="TRANSFER_STATE_COMPLETE")return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));g.o1(C,3);return g.I(C,DE_(l,E,!0),5);case 5:g.sZ(C,4);break;case 3:return g.I1(C),C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e))}})},UEu=function(l,E){var e,d,C,x,Y,B,q,O,M,v;
return g.P(function(N){switch(N.V){case 1:return e=OF(E),d=g.z6(E.entityKey).entityId,g.I(N,zO(l.C,{mode:"readonly",Xo:!0},function(J){var b=TO(J,E.entityKey,"transfer");J=TO(J,g.rt(d,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.KU.all([b,J])}),2);
case 2:C=N.C;x=g.U(C);Y=x.next().value;B=x.next().value;q=Y;O=B;if(!q||q.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return N.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));g.o1(N,3);q.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.I(N,rZ(l.C,q,"transfer"),5);case 5:M=g.z6(q.key).entityId;dtx({videoId:M,fq:q,offlineModeType:(v=O)==null?void 0:v.offlineModeType});g.sZ(N,4);break;case 3:return g.I1(N),N.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",
e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return N.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e))}})},DE_=function(l,E,e){e=e===void 0?!1:e;
var d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q;return g.P(function(A){switch(A.V){case 1:return d=g.T(E.actionMetadata,mEu),C=g.z6(E.entityKey).entityId,x=g.rt(C,"downloadStatusEntity"),g.I(A,zO(l.C,{mode:"readonly",Xo:!0},function(f){var h=TO(f,x,"downloadStatusEntity");f=TO(f,g.rt(C,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.KU.all([h,f])}),2);
case 2:return Y=A.C,B=g.U(Y),q=B.next().value,O=B.next().value,M=q,v=O,N="TRANSFER_STATE_TRANSFER_IN_QUEUE",((J=M)==null?void 0:J.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(N="TRANSFER_STATE_PAUSED_BY_USER"),H={key:E.entityKey,transferState:N,cotn:g.bT(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(b=d)==null?void 0:b.maximumDownloadQuality,preferredAudioTrack:(m=d)==null?void 0:m.preferredAudioTrack,transferRetryCount:0,isRefresh:e,hasLoggedFirstStarted:!1},g.I(A,zO(l.C,
{mode:"readwrite",Xo:!0},function(f){var h=[];e&&h.push(GO(f,g.rt(C,"offlineVideoStreams")));h.push(jn(f,H,"transfer"));return g.KU.all(h)}),3);
case 3:if(!e){A.jZ(4);break}return g.I(A,qdN(C),4);case 4:E2B({videoId:C,fq:H,offlineModeType:(Q=v)==null?void 0:Q.offlineModeType}),g.Vg(A)}})},tcH=function(l,E,e,d){if(!l.action.entityKey)throw Error("entityKey is missing.");
var C=g.z6(l.action.entityKey);C={entityType:C.DI,entityId:C.entityId,offlineOrchestrationActionType:l.action.actionType,orchestrationAction:{orchestrationActionId:l.actionId}};E&&(C.offlineOrchestrationActionResult=E.status,C.isRetryable=e?!1:E.C,E.G&&(C.offlineOrchestrationFailureReason=yBx(E.G,C.isRetryable)));var x,Y;if((x=l.action.actionMetadata)==null?0:(Y=x.offlineLoggingData)==null?0:Y.offlineModeType)C.offlineModeType=l.action.actionMetadata.offlineLoggingData.offlineModeType;d&&(C.additionalOrchestrationActions=
d.map(function(B){return{orchestrationActionId:B.actionId}}));
return C},yBx=function(l,E){return l!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||E?l==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&E?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":l:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},HZD=function(l,E){var e={offlineOrchestrationContext:tcH(l)};
E=c0K(E,e);i5D(L46(),E,l.rootActionId)},Vcx=function(l,E,e,d){d=d===void 0?[]:d;
E={offlineOrchestrationContext:tcH(l,E,e,d)};E=c0K(3,E);i5D(L46(),E,l.rootActionId)},oPx=function(){this.actions=[]},ABK=function(l,E){E=g.U(E);
for(var e=E.next();!e.done;e=E.next())e=e.value,HZD(e,1),l.actions.push(e);l.actions.sort(l.C)},QdR=function(l,E){if(E)for(var e=0;e<l.actions.length;e++)if(E==="!*$_ALL_ENTITIES_!*$"&&l.actions[e].actionId!==E||E!=="!*$_ALL_ENTITIES_!*$"&&l.actions[e].rootActionId===E&&l.actions[e].actionId!==E)l.actions.splice(e,1),e--},sdH=function(l,E){l=g.U(l.actions);
for(var e=l.next();!e.done;e=l.next())if(e.value.actionId===E)return!0;return!1},i6=function(l,E,e,d,C){g.F.call(this);
var x=this;this.V=l;this.vS=E;this.o4=e;this.Y=d;this.Mw=C;this.C=new oPx;this.X=new g.i8;this.G=new g.Gv(function(){x.retry()});
this.K=NaN;this.Z=!1;this.qj={Ndk:function(){return x.C},
eI:function(){return x.X},
lP4:function(){return x.G},
retry:function(){return x.retry()}};
g.L(this,this.G);this.U=this.V.observe(this.VV.bind(this))},foH=function(l,E,e,d,C){var x;
return g.P(function(Y){if(Y.V==1)return x=new i6(l,E,e,d,C),g.I(Y,aoB(x),2);IoK(x);return Y.return(x)})},IoK=function(l){var E=l.C.actions[0];
return l.W?((E==null?void 0:E.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&l.W[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(l.Z=!0),Promise.resolve()):P9B(l)},P9B=function(l){var E,e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q;
return g.P(function(A){switch(A.V){case 1:if(l.W)throw Error("Already processing an action");if(l.BS())return A.return();E=l.C.actions.shift();n0_(l.o4,!E);if(E===void 0)return A.return();E.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&E.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&QdR(l.C,E.actionId);e="";E.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&E.rootActionId===E.actionId&&(e=E.actionId);d=[E];l.W=d;if(C=l.vS[E.entityType]){A.jZ(2);break}l.W=
void 0;return g.I(A,P9B(l),3);case 3:return A.return();case 2:x=g.U(d);for(Y=x.next();!Y.done;Y=x.next())B=Y.value,HZD(B,2);g.o1(A,4,5);return g.I(A,Snx(C,d.map(function(f){return f.action})),7);
case 7:q=A.C,O=g.U(d),M=O.next();case 8:if(M.done){A.jZ(10);break}v=M.value;N=q.get(v.action);return g.I(A,RJN(l,v,N),9);case 9:M=O.next();A.jZ(8);break;case 10:QdR(l.C,e);case 5:g.kT(A);l.W=void 0;g.hP(A,6);break;case 4:return J=g.I1(A),Cz("Orchestration error",J),g.o1(A,12),g.I(A,kdB(l,d),14);case 14:g.sZ(A,5);break;case 12:b=g.I1(A);Cz("Orchestration retry error",b);m=g.U(d);for(H=m.next();!H.done;H=m.next())Q=H.value,Q.retryScheduleIndex<3&&ABK(l.C,[Q]);A.jZ(5);break;case 6:return g.I(A,P9B(l),
0)}})},RJN=function(l,E,e){var d,C,x,Y,B,q,O,M,v,N,J,b;
return g.P(function(m){switch(m.V){case 1:d=E.retryScheduleIndex+2===3;if(e.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){m.jZ(2);break}if(e.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){m.jZ(0);break}Vcx(E,e,d);if(e.C&&E.retryScheduleIndex+1<3)return g.I(m,kdB(l,[E]),0);x=((C=e)==null?0:C.V)?e.V:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";Y={entityKey:E.action.entityKey,failureReason:x};B=void 0;g.Vr(l.Mw)?B="mainVideoDownloadStateEntity":g.Rn(l.Mw)&&(B="musicTrackDownloadMetadataEntity");
if(!B||!e.downloadState){m.jZ(7);break}q=g.z6(E.action.entityKey).entityId;return g.I(m,J6(q,B,l.V,e.downloadState),7);case 7:Yf(l.Y,Y);if(e.downloadState==="DOWNLOAD_STATE_FAILED"&&l.Mw.B("html5_auto_retry_failed_pde_actions")){m.jZ(0);break}Cz("Orchestration result is not retryable, deleting action");return g.I(m,K4H(l.V,mw(E).key),0);case 2:O=void 0;try{O=(M=e.W)==null?void 0:M.map(function(H){return l.createAction(H,E)})}catch(H){return Vcx(E,e,d),v={entityKey:E.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},Yf(l.Y,v),Cz("Orchestration subactions creation error",H),m.return()}Vcx(E,e,d,O);if(!O){m.jZ(12);break}N=O.map(function(H){return mw(H)});
J=0;case 13:if(!(J<O.length)||l.Z){m.jZ(15);break}return g.I(m,zO(l.V,{mode:"readwrite",Xo:!0},function(H){var Q=[];Q.push(BVB(H,N.slice(J,J+10),"offlineOrchestrationActionWrapperEntity"));return g.KU.all(Q)}),16);
case 16:J+=10;m.jZ(13);break;case 15:if(l.Z)return l.Z=!1,m.return();case 12:return b=mw(E),g.I(m,K4H(l.V,b.key),17);case 17:HZD(E,4),g.Vg(m)}})},cBW=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J;
return g.P(function(b){e=[];d=Infinity;C=4E3;x=g.U(E);for(Y=x.next();!Y.done;Y=x.next())B=Y.value,q=Number(B.enqueueTimeSec),O=hJo(q),M=B.retryScheduleIndex,v=M!=null&&M>0,O>0&&v?(d=Math.min(d,q),C=Math.min(O,C)):e.push(B);isFinite(d)&&(!l.G.isActive()||d<l.K)&&(l.K=d,l.G.start(C));l.X.Gq()||(N=e.length,e=e.filter(function(m){var H;m=((H=m.actionProto)==null?void 0:H.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!FP6.includes(m)}),J=e.length<N,!l.G.isActive()&&J&&l.G.start(1));
e.length>0&&LP6(l,e);return g.I(b,IoK(l),0)})},ZZ5=function(l){var E,e,d,C,x,Y,B;
return g.P(function(q){if(q.V==1)return g.I(q,iZ_(l),2);E=q.C;e=[];d=g.U(E);for(C=d.next();!C.done;C=d.next())x=C.value,Y=g.z6(x.key),B=Y.entityId,sdH(l.C,B)||e.push(x);return g.I(q,cBW(l,e),0)})},hJo=function(l){l=l*1E3-Date.now();
return l>4E3?4E3:l},kdB=function(l,E){var e,d,C;
return g.P(function(x){e=g.U(E);for(d=e.next();!d.done;d=e.next()){C=d.value;var Y=void 0,B=void 0,q=((B=C.action)==null?void 0:(Y=B.actionMetadata)==null?void 0:Y.retryScheduleIntervalsInSeconds)||[1,2,4];Y=1;C.retryScheduleIndex<q.length&&(Y=q[C.retryScheduleIndex]);C.C=Y*1E3+Date.now();C.retryScheduleIndex++}return g.I(x,$Eo(l,E),0)})},aoB=function(l){var E;
return g.P(function(e){if(e.V==1)return g.I(e,nN(l.V,"offlineOrchestrationActionWrapperEntity"),2);E=e.C;return g.I(e,cBW(l,E),0)})},LP6=function(l,E){E.length!==0&&E.forEach(function(e){e=UF(e);
e.retryScheduleIndex<3&&ABK(l.C,[e])})},iZ_=function(l,E){var e;
return g.P(function(d){if(d.V==1)return g.I(d,nN(l.V,"offlineOrchestrationActionWrapperEntity",E),2);e=d.C;return d.return(e.filter(o0H))})},$Eo=function(l,E){if(E.length===0)return Promise.resolve([]);
E=E.map(function(e){return mw(e)});
return pEN(l.V,E)},T4i=function(l){this.Y8=l;
this.C=void 0},gP_=function(l,E){var e,d,C,x;
return g.P(function(Y){e=E.videoId;d=!0;if(E.captionTracks.length)C=ElH(E),l.C=new g.Qc(l.Y8,E,C);else if(E.wF)x=g.S6R(E),l.C=new g.a$(l.Y8,E.wF,e,x,E.Uv,E.eventId),d=E.Uv;else return Y.return();return Y.return(new Promise(function(B){var q;(q=l.C)==null||q.iV({dk:function(){return g.P(function(O){if(O.V==1)return g.I(O,l.dk(e,d),2);B();g.Vg(O)})},
VO:function(){}})}))})},WPN=function(l){var E;
return g.P(function(e){if(e.V==1)return g.I(e,Is5(l),2);E=e.C;return e.return(!!E&&E.length>0)})},Zr=function(l){g.F.call(this);
this.C=l;this.V=this.C.observe(this.G.bind(this))},jd_=function(l,E){var e,d,C,x,Y,B,q;
return g.P(function(O){switch(O.V){case 1:if(E.length===0)return O.return([]);e=E.map(function(M){return g.rt(M,"transfer")});
return g.I(O,nN(l.C,"transfer",e),2);case 2:d=O.C;C=d.filter(o0H).map(function(M){return g.z6(M.key).entityId});
x=E.filter(function(M){return C.indexOf(M)===-1});
if(x.length===0)return O.return([]);Y=g.U(x);B=Y.next();case 3:if(B.done){O.jZ(5);break}q=B.value;return g.I(O,qdN(q),4);case 4:B=Y.next();O.jZ(3);break;case 5:return O.return(x)}})},Sd5=function(l,E,e,d,C,x){var Y,B,q;
return g.P(function(O){Y="STREAM_TYPE_UNKNOWN";e.video&&e.audio?(Y="STREAM_TYPE_AUDIO_AND_VIDEO",Cz("unexpected stream type")):e.video&&!e.audio?Y="STREAM_TYPE_VIDEO":!e.video&&e.audio&&(Y="STREAM_TYPE_AUDIO");B=g.rt(E,"offlineVideoStreams");q={numBytesDownloaded:C.toFixed(),numTotalBytes:x.toFixed(),streamType:Y,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(d),itag:Y==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(e.itag):void 0};return g.I(O,zO(l,{mode:"readwrite",Xo:!0},
function(M){var v=TO(M,B,"offlineVideoStreams"),N=TO(M,g.rt(E,"transfer"),"transfer");return g.KU.all([v,N]).then(function(J){J=g.U(J);var b=J.next().value;J=J.next().value;if(!J)return GO(M,B).then(function(){});
var m=Gd6(b);b=XNH(b,d,q,B);var H=jn(M,b,"offlineVideoStreams");Gd6(b)>m&&(J.lastProgressTimeMs=Date.now().toString());m=[H];J.offlineVideoStreams||(J.offlineVideoStreams=[]);J.offlineVideoStreams.indexOf(B)===-1&&(J.offlineVideoStreams.push(B),m.push(jn(M,J,"transfer")));return g.KU.all(m)})}),0)})},zJK=function(l,E){var e,d,C,x,Y;
return g.P(function(B){if(B.V==1)return e=g.rt(E,"offlineVideoStreams"),g.I(B,wZ(l,e,"offlineVideoStreams"),2);d=B.C;if(!d||!d.streamsProgress)return B.return();C=g.U(d.streamsProgress);for(x=C.next();!x.done;x=C.next())Y=x.value,Y.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",Y.numTotalBytes!==Y.numBytesDownloaded&&(Y.numBytesDownloaded=Y.numTotalBytes);return g.I(B,rZ(l,d,"offlineVideoStreams"),0)})},XNH=function(l,E,e,d){if(l&&l.streamsProgress){d=l;
a:{E=E.itag+";"+E.xtags;for(var C=l.streamsProgress,x=0;x<C.length;x++){var Y=JSON.parse(C[x].formatStreamBytes);if(Y.itag+";"+Y.xtags===E){C[x]=e;e=C;break a}}C.push(e);e=C}d.streamsProgress=e}else l={key:d,streamsProgress:[e]};return l},Gd6=function(l){if(l==null?0:l.streamsProgress){var E=0;
l=l.streamsProgress;for(var e=0;e<l.length;e++){var d=l[e];isNaN(Number(d.numBytesDownloaded))?Cz("stream progress bytes number invalid"):E+=Number(d.numBytesDownloaded)}return E}return 0},rB5=function(l,E,e,d){g.F.call(this);
var C=this;this.V=l;this.api=E;this.tO=e;this.VV=d;this.X=new g.i8;this.W=new g.Gv(function(){C.C&&C.C.transferState==="TRANSFER_STATE_TRANSFERRING"&&C.X.Gq()&&((C.C.transferRetryCount||0)<3?cm(C.Y,C.Z,!1,!1):Lz(C.Y,C.Z.videoDetails.videoId),C.dJ("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.o4=this.WS=0;this.U=this.K=!1;this.E6=g.CV(this.api.N().experiments,"html5_transfer_processing_logs_interval");this.hO=new g.oE(this);this.qj={kH2:function(){return C.W},
aPO:function(){return C.VV},
eI:function(){return C.X}};
this.vS=this.V.observe(this.P3.bind(this));this.Y=new B4B(E,this);this.bO=new T4i(E);this.pJ=new Zr(this.V);this.DQ=this.X.listen("publicytnetworkstatus-online",this.LY.bind(this));this.s6=this.X.listen("publicytnetworkstatus-offline",this.n0O.bind(this));this.U=this.api.N().B("html5_less_transfer_processing_logs");g.L(this,this.hO);this.hO.L(E,"offlinetransferpause",this.QcK);if(g.Vr(this.api.N()))this.G="mainVideoDownloadStateEntity";else if(g.Rn(this.api.N())||g.AS(this.api.N()))this.G="musicTrackDownloadMetadataEntity"},
wNi=function(l){return g.P(function(E){if(E.V==1)E=g.I(E,saH(),2);
else{var e=l.pJ;var d=g.C0();d=Object.keys(d);e=jd_(e,d);E=g.I(E,e,0)}return E})},TR=function(l,E){E=E===void 0?!1:E;
var e;return g.P(function(d){if(d.V==1){if(l.C)throw Error("Already downloading a video");l.o4=0;l.K=!1;return g.I(d,nPB(l),2)}return d.V!=4?(e=d.C,lIK(l.tO,!e),e&&l.X.Gq()?E?g.I(d,new Promise(function(C){g.MV(C,1E3)}),4):d.jZ(4):(!e&&l.C&&$f(l),d.jZ(0))):g.I(d,li6(l,e),0)})},Eao=function(l){return g.P(function(E){if(E.V==1)return l.Z?g.I(E,Lz(l.Y,l.Z.videoDetails.videoId),3):E.jZ(0);
$f(l);g.Vg(E)})},eM5=function(l,E){var e,d,C;
return g.P(function(x){switch(x.V){case 1:return g.o1(x,2),(e=!!E.captionTracks.length||!!E.wF)?g.I(x,WPN(E.videoId),4):x.return();case 4:return(d=x.C)?x.return():g.I(x,gP_(l.bO,E),5);case 5:g.sZ(x,0);break;case 2:C=g.I1(x),Cz("Caption downloading error",C,E.cotn),g.Vg(x)}})},li6=function(l,E){var e,d,C,x,Y,B;
return g.P(function(q){switch(q.V){case 1:if(l.K)return q.return();l.K=!0;l.C=E;e=g.z6(l.C.key);d=e.entityId;C=void 0;if(l.C.transferState==="TRANSFER_STATE_TRANSFERRING")return g.I(q,gi(l,d),7);if(l.C.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||l.C.transferRetryCount||l.C.hasLoggedFirstStarted){q.jZ(3);break}return g.I(q,gi(l,d),5);case 5:return C=q.C,l.C.hasLoggedFirstStarted=!0,g.I(q,de_(l),6);case 6:esx({videoId:d,fq:l.C,offlineModeType:C},void 0,void 0,!0);q.jZ(3);break;case 7:C=q.C,
qb({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:d,fq:l.C,offlineModeType:C});case 3:return g.I(q,C7t(l),8);case 8:return x=null,g.o1(q,9),g.I(q,xe5(l,E),11);case 11:x=q.C;l.Z=x;g.sZ(q,10);break;case 9:return Y=g.I1(q),Cz("error getting player response",Y,E.cotn),g.I(q,l.dJ("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return q.return();case 10:return B=qnH(l.api.N(),E.cotn,x),g.I(q,eM5(l,B),13);case 13:return g.I(q,OZx(B.videoId),
14);case 14:B.Y$=q.C,JBo(l.Y,B,E.maximumDownloadQuality),l.W.start(108E5),g.Vg(q)}})},nPB=function(l){var E,e;
return g.P(function(d){if(d.V==1)return g.I(d,nN(l.V,"transfer"),2);E=d.C;e=E.filter(YBW).sort(usR);return e.length===0?d.return():d.return(e[0])})},C7t=function(l){var E,e,d;
return g.P(function(C){if(C.V==1){if(!l.C)return Wm(l,"onTransferStart"),C.return();l.W.start(108E5);return g.I(C,jj(l,"TRANSFER_STATE_TRANSFERRING"),2)}E=l.C;return(d=((e=E)==null?0:e.key)?g.z6(E.key).entityId:"")&&l.G?g.I(C,J6(d,l.G,l.V,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):C.jZ(0)})},vPx=function(l){var E,e,d,C;
g.P(function(x){switch(x.V){case 1:if(!l.C){Wm(l,"onTransferPausedByUser");x.jZ(2);break}E=l.C;l.W.stop();return g.I(x,jj(l,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:d=((e=E)==null?0:e.key)?g.z6(E.key).entityId:"";if(!d||!l.G){x.jZ(4);break}return g.I(x,J6(d,l.G,l.V,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.I(x,gi(l,d),6);case 6:C=x.C,CSx({videoId:d,fq:E,offlineModeType:C});case 2:$f(l),TR(l),g.Vg(x)}})},N4D=function(l){var E,e,d;
g.P(function(C){if(C.V==1){if(!l.C)return Wm(l,"onTransferPausedByNetwork"),C.return();l.W.stop();return g.I(C,jj(l,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(C.V!=3)return E=l.C,(d=((e=E)==null?0:e.key)?g.z6(E.key).entityId:"")&&l.G?g.I(C,J6(d,l.G,l.V,"DOWNLOAD_STATE_PAUSED"),3):C.jZ(3);$f(l);g.Vg(C)})},B6D=function(l){var E,e,d,C,x;
g.P(function(Y){switch(Y.V){case 1:if(!l.C)return Wm(l,"onTransferComplete"),Y.return();E=l.C;l.W.stop();if(!E||!l.Z){Y.jZ(2);break}e=qnH(l.api.N(),E.cotn,l.Z);return g.I(Y,eM5(l,e),2);case 2:return g.I(Y,jj(l,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:C=((d=E)==null?0:d.key)?g.z6(E.key).entityId:"";if(!C||!l.G){Y.jZ(5);break}return g.I(Y,J6(C,l.G,l.V,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.I(Y,zJK(l.V,C),7);case 7:return g.I(Y,gi(l,C),8);case 8:x=Y.C,qb({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:C,fq:E,offlineModeType:x}),$f(l),TR(l),g.Vg(Y)}})},qBH=function(l,E,e){var d,C;
g.P(function(x){switch(x.V){case 1:if(!l.C)return Wm(l,"onTransferProgress: "+E),x.return();if(l.C.transferState==="TRANSFER_STATE_TRANSFERRING"){x.jZ(2);break}return g.I(x,C7t(l),2);case 2:d=Date.now();if(!(d-l.WS>1E3)){x.jZ(4);break}l.WS=d;return g.I(x,Sd5(l.V,e.videoId,e.V,e.E9,e.bytesDownloaded,e.C),5);case 5:if(l.U&&!(l.U&&d-l.o4>l.E6)){x.jZ(4);break}l.o4=d;return g.I(x,gi(l,E),7);case 7:C=x.C,esx({videoId:E,fq:l.C,offlineModeType:C},e.bytesDownloaded,e.C);case 4:l.W.start(108E5),g.Vg(x)}})},
Or_=function(l){var E=(l.C.transferRetryCount||0)<3;
E&&(l=l.C,l.transferRetryCount=(l.transferRetryCount||0)+1);return E},MVD=function(l,E){E=E===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":E;
var e,d,C,x;return g.P(function(Y){if(Y.V==1)return l.C||Wm(l,"setTransferToFailed: "+E),e="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",E==="TRANSFER_FAILURE_REASON_NETWORK"?e="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":E==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(e="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.I(Y,jj(l,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",E),2);if(Y.V!=3)return Yf(l.VV,{entityKey:(d=l.C)==null?void 0:d.key,failureReason:e}),
C=l.C?g.z6(l.C.key).entityId:"",g.I(Y,gi(l,C),3);x=Y.C;var B={videoId:C,fq:l.C,offlineModeType:x},q=E,O={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};q&&(O.transferFailureReason=q,O.failureReason=xtt(q));qb(O,B);g.Vg(Y)})},jj=function(l,E,e,d){var C;
return g.P(function(x){if(x.V==1){if(!l.C)return Wm(l,"saveTransferState: "+E),x.return();l.C.transferState=E;l.C.failureReason=d;g.o1(x,2);return g.I(x,de_(l,function(Y){return e?gZ(Y,"offlineVideoStreams",l.C.offlineVideoStreams).then(function(B){for(var q=g.U(B),O=q.next();!O.done;O=q.next())if((O=O.value)&&O.streamsProgress){O=g.U(O.streamsProgress);for(var M=O.next();!M.done;M=O.next())M.value.streamState=e}return BVB(Y,B.filter(function(v){return!!v}),"offlineVideoStreams")}):g.KU.resolve(void 0)}),
4)}if(x.V!=2)return g.sZ(x,0);
C=g.I1(x);return C instanceof g.MH&&C.type==="QUOTA_EXCEEDED"?g.I(x,l.dJ("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):x.jZ(0)})},de_=function(l,E){var e;
return g.P(function(d){if(!l.C)return d.return();e=l.C;return g.I(d,zO(l.V,{mode:"readwrite",Xo:!0},function(C){var x=[jn(C,e,"transfer")];E&&x.push(E(C));return g.KU.all(x)}),0)})},$f=function(l){l.C=void 0;
l.Z=void 0;l.W.stop()},xe5=function(l,E){var e,d,C,x,Y;
return g.P(function(B){if(B.V==1)return e=g.z6(E.key),d=e.entityId,C=g.rt(d,"playbackData"),g.I(B,wZ(l.V,C,"playbackData"),2);x=B.C;if((Y=x)==null?0:Y.playerResponseJson)return B.return(JSON.parse(x.playerResponseJson));throw Error("No PlayerResponse found");})},Wm=function(l,E){l.api.CJ("woffle",{mcte:E});
Cz("missing current transfer entity.")},gi=function(l,E){var e,d,C;
return g.P(function(x){if(x.V==1)return g.I(x,wZ(l.V,g.rt(E,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);e=x.C;return x.return((C=(d=e)==null?void 0:d.offlineModeType)!=null?C:void 0)})},YBW=function(l){return vai[l.transferState]!==void 0},usR=function(l,E){var e=vai[l.transferState],d=vai[E.transferState];
return e!==d?e-d:Number(l.enqueuedTimestampMs)-Number(E.enqueuedTimestampMs)},GR=function(l,E){var e=this;
this.Mw=l;this.api=E;this.X=new g.i8;this.Z=new g.N0;this.qj={SI:function(){return e.G.qj.SI()},
eI:function(){return e.X},
t64:function(){return e.G},
oQ:function(){return e.oQ()},
Zp:function(){return e.Zp()},
hf:function(){return e.hf()},
fz:function(){return e.fz()},
Lz:function(){return e.Lz()},
Tc:function(d){return e.Tc(d)}};
this.G=new zNK(function(){return N6u(e)},function(){e.hf()},this.api.OP(),this.api.B.bind(this.api));
this.C=new xf(this.api);r0i(this.G)},N6u=function(l){return g.P(function(E){l.api.x8("onOrchestrationBecameLeader");
return g.I(E,l.Zp(),0)})},brt=function(l){var E,e;
return g.P(function(d){if(d.V==1)return g.I(d,l6(),2);if(d.V!=3){E=d.C;if(!E)return Cz("PES is undefined"),d.return();l.V=new rB5(E,l.api,l.G,l.C);e=l.IM(E);return g.I(d,foH(E,e,l.G,l.C,l.Mw),3)}l.Y=d.C;return g.I(d,Jgu(l),0)})},Jgu=function(l){var E;
return g.P(function(e){switch(e.V){case 1:if(!l.V)return Cz("transferManager is undefined"),e.return();if(l.V.C){e.jZ(2);break}return g.I(e,TR(l.V),2);case 2:if(!l.Mw.B("woffle_enable_main_downloads_library")){e.jZ(4);break}return g.I(e,l.QD(),4);case 4:if(!l.Mw.B("html5_offline_playback_position_sync")){e.jZ(6);break}return g.I(e,l.oD(),7);case 7:return g.I(e,l.Tc(864E5),6);case 6:return g.I(e,l.refreshAllStaleEntities(43200,!0),9);case 9:return g.I(e,l.f7(),10);case 10:if(!l.Mw.B("html5_retry_downloads_for_expiration")){e.jZ(11);
break}return g.I(e,l.Lz(),11);case 11:return l.K=g.vn(function(){l.refreshAllStaleEntities(43200,!0);l.f7()},9E5),g.GZ(g.Se(),function(){return l.fz()}),g.I(e,l6(),13);
case 13:return E=e.C,g.I(e,Sex(E),14);case 14:wEt(l.G),g.Vg(e)}})},DeK=function(){var l,E,e,d,C,x;
return g.P(function(Y){switch(Y.V){case 1:return g.I(Y,l6(),2);case 2:l=Y.C;if(!l)return Y.return([]);E=Date.now()/1E3;return g.I(Y,nN(l,"offlineVideoPolicy"),3);case 3:e=Y.C,d=g.U(e),C=d.next();case 4:if(C.done){Y.jZ(6);break}x=C.value;if(!(x.expirationTimestamp&&Number(x.expirationTimestamp)<E)){Y.jZ(5);break}x.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";x.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.I(Y,rZ(l,x,"offlineVideoPolicy"),5);
case 5:C=d.next();Y.jZ(4);break;case 6:return Y.return(e.map(function(B){return B.key}))}})},XO=function(l,E,e,d,C){var x,Y,B;
return g.P(function(q){if(q.V==1)return g.I(q,l6(),2);x=q.C;if(!x)return q.return([]);Y=E.map(function(O){var M=g.rt(O,e);M={actionType:d,entityKey:M,actionMetadata:Object.assign({},OAx(),C)};d!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(M.actionMetadata.priority=0);O=new Kz(e,O,M);return mw(O)});
B=pEN(x,Y);r0i(l.G);return q.return(B)})},p4H=function(l,E,e,d){var C,x,Y,B,q,O,M,v;
return g.P(function(N){switch(N.V){case 1:C=[],x=g.U(E),Y=x.next();case 2:if(Y.done){N.jZ(4);break}B=Y.value;if(B.upToDate||e&&!B.shouldAutoSyncMetadata||!B.playlistId){N.jZ(3);break}q={};switch(d){case "mainPlaylistEntity":O={nextAutoRefreshIntervalSeconds:B.checkInSeconds,autoSync:e};q={mainPlaylistEntityActionMetadata:O};break;case "musicPlaylist":M={autoSync:e},q={musicPlaylistEntityActionMetadata:M}}return g.I(N,XO(l,[B.playlistId],d,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",q),6);case 6:(v=
N.C)&&C.push.apply(C,g.bZ(v));case 3:Y=x.next();N.jZ(2);break;case 4:return N.return(C)}})},KQi=function(l,E){var e;
return g.P(function(d){return E.length?(e=OAx(),g.P2(e,h6,{isEnqueuedForExpiredStreamUrlRefetch:!0}),l.api.CJ("qrd",{v:E.length}),d.return(XO(l,E,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",e))):d.return([])})},Uex=function(l,E,e){this.C=l;
this.Mw=E;this.G=e},tVt=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A;
return g.P(function(f){switch(f.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,x=[],g.o1(f,2),g.I(f,meB(l,C),4);case 4:x=f.C;if(!(l.Mw.B("woffle_enable_main_downloads_library")&&((Y=x)==null?0:Y.length))){f.jZ(5);break}return g.I(f,HAo(l.C,[E.entityKey]),5);case 5:g.sZ(f,3);break;case 2:return B=g.I1(f),q="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",O="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.MH&&B.type==="QUOTA_EXCEEDED"?(q="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
O="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):Cz("Playlist add error"),f.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,q,O));case 3:M=[];if(!l.Mw.B("html5_offline_prevent_redownload_downloaded_video")){f.jZ(7);break}return g.I(f,BGt(l.C,"mainVideoEntity",x),8);case 8:x=f.C;case 7:if((v=x)==null?0:v.length)for(N=g.U(x),J=N.next();!J.done;J=N.next())if(b=J.value,m=b.offlineVideoData,H=void 0,(H=m)==null?0:H.videoId)Q=void 0,A=Number(((Q=E.actionMetadata)==null?void 0:Q.priority)||
0)+1,M.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",m.videoId,"mainVideoEntity",A,Sj,ygu(E,m,C)));return f.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,M))}})},VVD=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn,ki,dr,AH,y,EZ,sp,OK,$i,jR,eB,Cy,W9,t,K,V,R,c,tP,S,n,k,UZ,yx,uZ,Ou,G2,Qg,eO,oN,i_,a1,H_,PB,hH,Qx;
return g.P(function(Op){switch(Op.V){case 1:return e=OF(E),d=E.entityKey,C=g.z6(d).entityId,x=[],Y=!1,C==="!*$_ALL_ENTITIES_!*$"?(Y=!0,g.I(Op,nN(l.C,"mainPlaylistEntity"),5)):g.I(Op,wZ(l.C,d,"mainPlaylistEntity"),4);case 4:(B=Op.C)&&x.push(B);Op.jZ(3);break;case 5:x=Op.C;case 3:if((q=x)==null||!q.length)return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));O=g.T(E.actionMetadata,Hrx);v=(M=O)==null?void 0:M.nextAutoRefreshIntervalSeconds;J=(N=O)==null?void 0:N.autoSync;b=[];H=m=
!0;Q=!1;if(!Y&&J===!1){Op.jZ(6);break}g.o1(Op,7);return g.I(Op,LH5(0,!!J,!0,x),9);case 9:b=Op.C;g.sZ(Op,8);break;case 7:A=g.I1(Op);if(!(A instanceof Error&&A.message==="No data")){A instanceof Error&&A.message==="Empty response body"&&Cz(A.message);Op.jZ(8);break}return C==="!*$_ALL_ENTITIES_!*$"?g.I(Op,pvW(l.C,E,l.G,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.I(Op,bAN(C,l.C,E,l.G),8);case 8:if(!b.length||!Y&&b[0].playlistId!==C)return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e));case 6:if(Y){f=[];h=g.U(b);for(Z=h.next();!Z.done;Z=h.next())r=Z.value,r.upToDate||J&&!r.shouldAutoSyncMetadata||!r.playlistId||(X={nextAutoRefreshIntervalSeconds:r.checkInSeconds,autoSync:J},f.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",r.playlistId,"mainPlaylistEntity",0,Sj,{mainPlaylistEntityActionMetadata:X})));return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,f))}b.length&&(qo=b[0],Q=!!qo.upToDate,J&&(m=(BB=qo.shouldAutoSyncMetadata)!=null?BB:!0,H=(OZ=qo.shouldAutoSyncVideos)!=
null?OZ:!0,qo.checkInSeconds&&(v=qo.checkInSeconds)));if(Q||!m)return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));No=[];eR=x[0];if(!eR.downloadState){fs=void 0;Op.jZ(15);break}return g.I(Op,wZ(l.C,eR.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:fs=Op.C;case 15:return SR=fs,po=((l_=SR)==null?0:l_.addedTimestampMillis)?String(SR.addedTimestampMillis):void 0,g.o1(Op,17),g.I(Op,meB(l,C,po,v),19);case 19:No=Op.C;g.sZ(Op,18);break;case 17:B6=g.I1(Op);if(!(B6 instanceof
Error&&B6.message==="No data for playlist")){if(B6 instanceof Error&&B6.message==="Empty response body for playlist")Cz(B6.message);else return R1="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B9="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B6 instanceof g.MH&&B6.type==="QUOTA_EXCEEDED"&&(R1="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",B9="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,R1,B9));
Op.jZ(18);break}return g.I(Op,bAN(C,l.C,E,l.G),18);case 18:if(!H)return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));c6=[];jB=new Map;if((qh=No)==null?0:qh.length)for(a=g.U(No),gn=a.next();!gn.done;gn=a.next())ki=gn.value,dr=ki.offlineVideoData,AH=void 0,((AH=dr)==null?0:AH.videoId)&&jB.set(dr.videoId,dr);y=new Map;EZ=[];if((sp=eR)==null?0:(OK=sp.videos)==null?0:OK.length)for($i=g.U(eR.videos),jR=$i.next();!jR.done;jR=$i.next())if(eB=jR.value,Cy=JSON.parse(g.z6(eB).entityId),
W9=Cy.videoId)jB.has(W9)?(y.set(W9,jB.get(W9)),jB.delete(W9)):EZ.push(W9);K=Number(((t=E.actionMetadata)==null?void 0:t.priority)||0)+1;V=g.U(jB.entries());for(R=V.next();!R.done;R=V.next())c=R.value,tP=g.U(c),S=tP.next().value,n=tP.next().value,k=S,UZ=n,c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",k,"mainVideoEntity",K,Sj,ygu(E,UZ,C)));yx=g.U(y.entries());for(uZ=yx.next();!uZ.done;uZ=yx.next())Ou=uZ.value,G2=g.U(Ou),Qg=G2.next().value,eO=G2.next().value,oN=Qg,i_=eO,c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
oN,"mainVideoEntity",K,Sj,ygu(E,i_,C)));a1=g.U(EZ);for(H_=a1.next();!H_.done;H_=a1.next())PB=H_.value,hH={playlistId:C},Qx={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:hH},c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",PB,"mainVideoEntity",0,Sj,Qx));return Op.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,c6))}})},oao=function(l,E){var e,d,C,x;
return g.P(function(Y){switch(Y.V){case 1:return e=OF(E),g.o1(Y,2),d=g.z6(E.entityKey).entityId,d==="!*$_ALL_ENTITIES_!*$"?g.I(Y,pvW(l.C,E,l.G,(C=E.actionMetadata)==null?void 0:(x=C.offlineLoggingData)==null?void 0:x.offlineDeleteReason),5):g.I(Y,bAN(d,l.C,E,l.G),6);case 6:if(!l.Mw.B("woffle_enable_main_downloads_library")){Y.jZ(5);break}return g.I(Y,V5D(l.C,E.entityKey),5);case 5:g.sZ(Y,3);break;case 2:return g.I1(Y),Y.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return Y.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e))}})},meB=function(l,E,e,d){var C,x,Y,B,q,O,M;
return g.P(function(v){switch(v.V){case 1:return g.I(v,hsu([E]),2);case 2:return C=v.C,g.I(v,AgN(l,C[0],e,d),3);case 3:return x=v.C,Y=x.mainPlaylistEntity,B=x.MB6,O=NGu(Y,(q=B)==null?void 0:q.avatar),g.o1(v,4),g.I(v,t6(O),6);case 6:g.sZ(v,5);break;case 4:M=g.I1(v),M instanceof Error&&M.message==="Failed to fetch"&&Cz(M.message);case 5:return v.return(C[0].videos)}})},AgN=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h;
return g.P(function(Z){switch(Z.V){case 1:C=Date.now().toString();e||(e=C);x=E.videos;Y=E.playlistId;B=[];q=[];if(x)for(O=g.U(x),M=O.next();!M.done;M=O.next()){v=M.value;N=v.offlineVideoData;if(!N||!N.videoId)throw Cz("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");J=N.videoId;b={videoId:J,playlistId:Y};m={id:g.rt(JSON.stringify(b),"mainPlaylistVideoEntity"),video:g.rt(J,"mainVideoEntity")};B.push(m);q.push(m.id)}Q={key:g.rt(Y,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:e,lastSyncedTimestampMillis:C};A={key:g.rt(Y,"mainPlaylistEntity"),playlistId:Y,videos:q,title:E.title,thumbnailStyleData:Q55(E),visibility:s5B(E),downloadState:Q.key};E.channel&&(f=E.channel.offlineChannelData,H=ait(g.rt(Y,"ytMainChannelEntity"),f),A.channelOwner=H.id);((h=A)==null?0:h.entityMetadata)?(A.entityMetadata.offlineLastModifiedTimestampSeconds=E.lastModifiedTimestamp,d&&(A.entityMetadata.nextAutoRefreshIntervalSeconds=String(d))):A&&(A.entityMetadata={nextAutoRefreshIntervalSeconds:d?
String(d):void 0,offlineLastModifiedTimestampSeconds:E.lastModifiedTimestamp});g.o1(Z,2);return g.I(Z,zO(l.C,{mode:"readwrite",Xo:!0},function(r){var X=jn(r,A,"mainPlaylistEntity"),qo=jn(r,Q,"mainPlaylistDownloadStateEntity");X=[X,qo];qo=g.U(B);for(var BB=qo.next();!BB.done;BB=qo.next())X.push(jn(r,BB.value,"mainPlaylistVideoEntity"));H&&X.push(jn(r,H,"ytMainChannelEntity"));return g.KU.all(X)}),4);
case 4:g.sZ(Z,3);break;case 2:throw g.I1(Z),Cz("PES failure for playlist"),Error("PES failure for playlist");case 3:return Z.return({mainPlaylistEntity:A,MB6:H,rZ9:B})}})},ait=function(l,E){return{id:l,
channelId:E.channelId,title:E.title,avatar:E.thumbnail}},Q55=function(l){var E=[],e=l.videos;
e&&e.length>0&&E.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:e[0].offlineVideoData.thumbnail}}});if((l=l.additionalMetadadatas)&&l.length>0)for(l=g.U(l),e=l.next();!e.done;e=l.next()){var d=e.value.offlineBundleItemPlaylistData,C=void 0;e=(C=d)==null?void 0:C.style;C=void 0;d={collageThumbnail:{coverThumbnail:(C=d)==null?void 0:C.coverThumbnail}};switch(e){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":E.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:d});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":E.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:d});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":E.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:d});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":E.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:d})}}return E},s5B=function(l){switch(l.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},ygu=function(l,E,e){E={offlineVideoData:E,
playlistId:e};if(l=g.T(l.actionMetadata,Hrx))E.maximumDownloadQuality=l.maximumDownloadQuality;return{mainVideoEntityActionMetadata:E}},IiK=function(l,E,e){this.C=l;
this.Mw=E;this.G=e},RMK=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b;
return g.P(function(m){switch(m.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,x=g.T(E.actionMetadata,zR),B=!((Y=x)==null?0:Y.playlistId),g.o1(m,2),g.I(m,fi_(l,C,void 0,(q=x)==null?void 0:q.offlineVideoData,B),4);case 4:g.sZ(m,3);break;case 2:return O=g.I1(m),M="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",O instanceof g.MH&&O.type==="QUOTA_EXCEEDED"&&(M="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
m.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,M,v));case 3:N=1;N=Number(((J=E.actionMetadata)==null?void 0:J.priority)||0)+1;var H=(H=g.T(E.actionMetadata,zR))?{playbackDataActionMetadata:{maximumDownloadQuality:H.maximumDownloadQuality}}:void 0;b=R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",C,"playbackData",N,P7u,H);return m.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,[b]))}})},kA5=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A;
return g.P(function(f){switch(f.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,g.I(f,wZ(l.C,E.entityKey,"mainVideoEntity"),2);case 2:x=f.C;if(!x){Y=void 0;f.jZ(3);break}return g.I(f,wZ(l.C,x.downloadState,"mainVideoDownloadStateEntity"),4);case 4:Y=f.C;case 3:B=Y;if(!x||!B)return f.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));g.o1(f,5);return g.I(f,fi_(l,C,B.addedTimestampMillis,(O=g.T(E.actionMetadata,zR))==null?void 0:O.offlineVideoData),7);case 7:M=1;M=Number(((v=
E.actionMetadata)==null?void 0:v.priority)||0)+1;q=R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",C,"playbackData",M,P7u);g.sZ(f,6);break;case 5:N=g.I1(f);if(!(N instanceof Error&&N.message==="No data")){if(N instanceof Error&&N.message==="Empty response body")Cz(N.message);else return J="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",b="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",N instanceof g.MH&&N.type==="QUOTA_EXCEEDED"&&(J="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
b="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),f.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,J,b));f.jZ(6);break}return g.I(f,o9(l.C,C),9);case 9:m=f.C;H=g.T(E.actionMetadata,zR);if(A=(Q=H)==null?void 0:Q.playlistId)m.playlistId=A;m.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.I(f,Hm(C,l.C,E,l.G,m),6);case 6:return f.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,q?[q]:void 0))}})},hMW=function(l,E){var e,d,C,x,Y,B,q,O,M,v;
return g.P(function(N){switch(N.V){case 1:return e=OF(E),g.o1(N,2),d=g.z6(E.entityKey).entityId,d==="!*$_ALL_ENTITIES_!*$"?g.I(N,pvW(l.C,E,l.G,(M=E.actionMetadata)==null?void 0:(v=M.offlineLoggingData)==null?void 0:v.offlineDeleteReason),5):g.I(N,o9(l.C,d),6);case 6:C=N.C;x=g.T(E.actionMetadata,zR);if(B=(Y=x)==null?void 0:Y.playlistId)C.playlistId=B;C.offlineDeleteReason=(q=E.actionMetadata)==null?void 0:(O=q.offlineLoggingData)==null?void 0:O.offlineDeleteReason;return g.I(N,Hm(d,l.C,E,l.G,C),7);
case 7:if(!l.Mw.B("woffle_enable_main_downloads_library")){N.jZ(5);break}return g.I(N,V5D(l.C,E.entityKey),5);case 5:g.sZ(N,3);break;case 2:return g.I1(N),N.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return N.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e))}})},fi_=function(l,E,e,d,C){var x,Y,B,q,O,M;
return g.P(function(v){switch(v.V){case 1:if(x=d){v.jZ(2);break}return g.I(v,kvt([E]),3);case 3:Y=v.C,x=Y[0];case 2:return g.I(v,FQK(l,x,e,C),4);case 4:B=v.C;q=B.mainVideoEntity;O=B.channelEntity;g.o1(v,5);var N=pz(q.thumbnail),J=pz(O.avatar);return g.I(v,t6(N.concat(J)),7);case 7:g.sZ(v,0);break;case 5:M=g.I1(v),M instanceof Error&&M.message==="Failed to fetch"&&Cz(M.message),g.Vg(v)}})},FQK=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N,J,b,m,H;
return g.P(function(Q){switch(Q.V){case 1:e||(e=Date.now().toString());x=(C=E.channel)==null?void 0:C.offlineChannelData;Y={id:g.rt(E.videoId,"ytMainChannelEntity"),channelId:x.channelId,title:x.title,avatar:x.thumbnail};B={key:g.rt(E.videoId,"mainVideoDownloadStateEntity"),playbackData:g.rt(E.videoId,"playbackData"),addedTimestampMillis:e,videoDownloadContextEntity:g.rt(E.videoId,"videoDownloadContextEntity")};q={key:g.rt(E.videoId,"videoPlaybackPositionEntity"),videoId:E.videoId,lastPlaybackPositionSeconds:"0"};
l.Mw.B("html5_offline_playback_position_sync")&&(O={playbackPosition:q.key});M=g.rt(E.videoId,"mainVideoEntity");v={key:M,videoId:E.videoId,title:E.title,thumbnail:E.thumbnail,localizedStrings:{viewCount:E.shortViewCountText},userState:O,lengthSeconds:E.lengthSeconds?Number(E.lengthSeconds):void 0,publishedTimestampMillis:E.publishedTimestamp?(Number(E.publishedTimestamp)*1E3).toString():void 0,formattedDescription:E.description,owner:Y.id,downloadState:B.key};if(!l.Mw.B("woffle_enable_main_downloads_library")||
!d){Q.jZ(2);break}return g.I(Q,t5W(l.C,[M]),3);case 3:if(b=Q.C)N=b.mainDownloadsLibraryEntity,J=b.mainDownloadsListEntity;case 2:return H=u7o,m={key:g.rt(E.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.P2(B,H,m),g.I(Q,zO(l.C,{mode:"readwrite",Xo:!0},function(A){var f=jn(A,Y,"ytMainChannelEntity"),h=jn(A,B,"mainVideoDownloadStateEntity"),Z=jn(A,v,"mainVideoEntity");f=[f,h,Z];l.Mw.B("html5_offline_playback_position_sync")&&(h=jn(A,q,"videoPlaybackPositionEntity"),
f.push(h));N&&(h=jn(A,N,"mainDownloadsLibraryEntity"),f.push(h));J&&(h=jn(A,J,"mainDownloadsListEntity"),f.push(h));m&&(A=jn(A,m,"downloadStatusEntity"),f.push(A));return g.KU.all(f)}),4);
case 4:return Q.return({mainVideoEntity:v,channelEntity:Y})}})},LQi=function(l,E,e){this.C=l;
this.Mw=E;this.G=e},irB=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR;
return g.P(function(fs){switch(fs.V){case 1:return e=OF(E),d=[],g.I(fs,id.getInstance(),2);case 2:C=fs.C;if(!C){fs.jZ(3);break}return g.I(fs,C.get("sdois"),4);case 4:return x=fs.C,g.I(fs,(B=C)==null?void 0:B.get("lmqf"),5);case 5:Y=fs.C;case 3:g.o1(fs,6);if(x===void 0)throw Error("prefStorage or opt-in state is undefined");q=[];if(x){fs.jZ(8);break}return g.I(fs,yWt(l.C),9);case 9:q=fs.C,q.reverse();case 8:if(!q.length){fs.jZ(10);break}O=g.U(q);M=O.next();case 11:if(M.done){fs.jZ(10);break}v=M.value;
if(!v){fs.jZ(12);break}N=g.z6(v).entityId;return g.I(fs,o9(l.C,N),14);case 14:return J=fs.C,J.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.I(fs,Hm(N,l.C,{entityKey:v,actionType:E.actionType},l.G,J),12);case 12:M=O.next();fs.jZ(11);break;case 10:return g.I(fs,iAu(x,(b=Y)!=null?b:"SD"),16);case 16:return m=fs.C,g.I(fs,KHR(m),17);case 17:H=mt_(m);if(!l.Mw.B("woffle_enable_main_downloads_library")){fs.jZ(18);break}if(x){fs.jZ(19);break}return g.I(fs,V5D(l.C,g.Lb),19);case 19:return g.I(fs,
HAo(l.C,[g.Lb]),18);case 18:if((Q=H)==null?0:Q.length)for(A=g.U(H),f=A.next();!f.done;f=A.next())if(Z=h=f.value,r=Z.actionType,X=Z.entityKey,qo=Z.actionMetadata,r&&X&&qo&&!g.T(qo,cgD)){r==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(qo.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(BB=g.T(h.actionMetadata,zR))BB.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",h.actionMetadata=Object.assign({},h.actionMetadata,{mainVideoEntityActionMetadata:BB});d.push(h)}g.sZ(fs,
7);break;case 6:return OZ=g.I1(fs),No="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",eR="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",OZ instanceof g.MH&&OZ.type==="QUOTA_EXCEEDED"&&(No="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",eR="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),fs.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,No,eR));case 7:return fs.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,d))}})},ZrR=function(){GR.apply(this,
arguments);
this.U="mainVideoEntity"},$eB=function(l,E,e){E=E===void 0?43200:E;
e=e===void 0?!0:e;var d=d===void 0?!1:d;var C,x,Y;return g.P(function(B){switch(B.V){case 1:if(!l.X.Gq())return B.return([]);C=[];g.o1(B,2);return g.I(B,LH5(E,e,d),4);case 4:C=B.C;g.sZ(B,3);break;case 2:x=g.I1(B),x instanceof Error&&x.message==="No data"||x instanceof Error&&x.message==="Empty response body"&&Cz(x.message);case 3:return Y=p4H(l,C,e,"mainPlaylistEntity"),B.return(Y)}})},T6x=function(l,E,e,d){d=d===void 0?!1:d;
var C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A;return g.P(function(f){switch(f.V){case 1:return C=[],g.I(f,cWx(),2);case 2:return(x=f.C)||d?g.I(f,ZAD(E,e),3):f.return([]);case 3:Y=f.C;if((B=Y)==null||!B.length)return f.return([]);q={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};O=g.U(Y);M=O.next();case 4:if(M.done){f.jZ(6);break}N=v=M.value;J=N.actionType;b=N.entityKey;m=N.actionMetadata;if(!(J&&b&&m)||g.T(m,cgD)){f.jZ(5);break}J==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(m.offlineLoggingData=
q);H=g.z6(b);Q=H.entityId;return g.I(f,XO(l,[Q],"mainVideoEntity",J,m),8);case 8:A=f.C,C=C.concat(A);case 5:M=O.next();f.jZ(4);break;case 6:return f.return(C)}})},gai=function(l,E){this.C=l;
this.G=E},j5W=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q;
return g.P(function(A){switch(A.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,x=[],g.o1(A,2),g.I(A,WQx(l,C),4);case 4:x=A.C;if((Y=x)==null||!Y.length){A.jZ(5);break}return g.I(A,aI6(l.C,E.entityKey),5);case 5:g.sZ(A,3);break;case 2:return B=g.I1(A),q="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",O="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.MH&&B.type==="QUOTA_EXCEEDED"&&(q="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",O="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
A.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,q,O));case 3:return M=[],g.I(A,BGt(l.C,"musicTrack",x),7);case 7:x=A.C;if(x.length)for(v=g.U(x),N=v.next();!N.done;N=v.next())if(J=N.value,b=J.offlineVideoData,m=void 0,(m=b)==null?0:m.videoId)H=void 0,Q=Number(((H=E.actionMetadata)==null?void 0:H.priority)||0)+1,M.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",b.videoId,"musicTrack",Q,ri,a9(E,b,C)));return A.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,M))}})},
GAR=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn,ki,dr,AH,y,EZ,sp,OK,$i,jR,eB,Cy,W9,t,K,V,R,c,tP,S,n;
return g.P(function(k){switch(k.V){case 1:return e=OF(E),d=E.entityKey,C=g.z6(d).entityId,x=[],Y=!1,C==="!*$_ALL_ENTITIES_!*$"?(Y=!0,g.I(k,nN(l.C,"musicAlbumRelease"),5)):g.I(k,wZ(l.C,d,"musicAlbumRelease"),4);case 4:(B=k.C)&&x.push(B);k.jZ(3);break;case 5:x=k.C;case 3:if((q=x)==null||!q.length)return k.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));if(Y){O=[];M=g.U(x);for(v=M.next();!v.done;v=M.next())N=v.value,J=g.z6(N.id).entityId,O.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
J,"musicAlbumRelease",0,ri));return k.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,O))}b=[];m=x[0];H=void 0;if(!m.downloadMetadata){k.jZ(6);break}return g.I(k,wZ(l.C,m.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:Q=k.C,H=Number((f=(A=Q)==null?void 0:A.addedTimestampMillis)!=null?f:"0")/1E3;case 6:return g.o1(k,8),g.I(k,WQx(l,C,(h=H)==null?void 0:h.toString()),10);case 10:b=k.C;g.sZ(k,9);break;case 8:Z=g.I1(k);if(!(Z instanceof Error&&Z.message==="No data")){if(Z instanceof
Error&&Z.message==="Empty response body")Cz(Z.message);else return r="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",X="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Z instanceof g.MH&&Z.type==="QUOTA_EXCEEDED"&&(r="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",X="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),k.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,r,X));k.jZ(9);break}return g.I(k,Qa(C,"musicAlbumRelease",l.C,E,l.G),9);case 9:qo=[];BB=new Map;
if((OZ=b)==null?0:OZ.length)for(No=g.U(b),eR=No.next();!eR.done;eR=No.next())fs=eR.value,SR=fs.offlineVideoData,l_=void 0,((l_=SR)==null?0:l_.videoId)&&BB.set(SR.videoId,SR);po=new Map;B6=[];if((R1=m)==null?0:(B9=R1.tracks)==null?0:B9.length)for(c6=g.U(m.tracks),jB=c6.next();!jB.done;jB=c6.next())if(qh=jB.value,a=g.z6(qh).entityId)BB.has(a)?(po.set(a,BB.get(a)),BB.delete(a)):B6.push(a);ki=Number(((gn=E.actionMetadata)==null?void 0:gn.priority)||0)+1;dr=g.U(BB.entries());for(AH=dr.next();!AH.done;AH=
dr.next())y=AH.value,EZ=g.U(y),sp=EZ.next().value,OK=EZ.next().value,$i=sp,jR=OK,qo.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",$i,"musicTrack",ki,ri,a9(E,jR)));eB=g.U(po.entries());for(Cy=eB.next();!Cy.done;Cy=eB.next())W9=Cy.value,t=g.U(W9),K=t.next().value,V=t.next().value,R=K,c=V,qo.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",R,"musicTrack",ki,ri,a9(E,c)));tP=g.U(B6);for(S=tP.next();!S.done;S=tP.next())n=S.value,qo.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",n,"musicTrack",
0,ri));return k.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,qo))}})},X46=function(l,E){var e,d;
return g.P(function(C){switch(C.V){case 1:return e=OF(E),g.o1(C,2),d=g.z6(E.entityKey).entityId,d==="!*$_ALL_ENTITIES_!*$"?g.I(C,sF(l.C,E,l.G),5):g.I(C,Qa(d,"musicAlbumRelease",l.C,E,l.G),6);case 6:return g.I(C,IIK(l.C,E.entityKey),5);case 5:g.sZ(C,3);break;case 2:return g.I1(C),C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},WQx=function(l,E,e){var d,C,x;
return g.P(function(Y){switch(Y.V){case 1:return g.I(Y,hsu([E]),2);case 2:return d=Y.C,g.I(Y,SBi(l,d[0],e),3);case 3:return C=Y.C,x=pz(C.thumbnailDetails),g.I(Y,t6(x),4);case 4:return Y.return(d[0].videos)}})},SBi=function(l,E,e){var d,C,x,Y,B,q,O,M,v,N,J,b,m,H;
return g.P(function(Q){if(Q.V==1){d=E.additionalMetadadatas;C=void 0;if(d&&d.length>0)for(x=g.U(d),Y=x.next();!Y.done;Y=x.next())if(B=Y.value,B.offlineMusicPlaylistData){C=B.offlineMusicPlaylistData;break}q=E.playlistId;O=fIo(E);M=O.n6;v=O.Sa;N=e?(Number(e)*1E3).toString():Date.now().toString();J=E.lastModifiedTimestamp?(Number(E.lastModifiedTimestamp)*1E3).toString():"0";b={id:g.rt(q,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:v,lastModifiedTimestampMillis:J,addedTimestampMillis:N,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};m={id:g.rt(q,"musicAlbumRelease"),title:E.title,audioPlaylistId:q,trackCount:E.totalVideoCount,tracks:M,downloadMetadata:b.id};C&&(m.thumbnailDetails=(H=C.albumHqThumbnail)!=null?H:C.albumArtistThumbnail,m.artistDisplayName=C.albumArtistDisplayName,m.releaseDate=C.albumReleaseDate,m.contentRating={explicitType:C.albumReleaseExplicitType},m.releaseType=C.albumReleaseType);return g.I(Q,zO(l.C,{mode:"readwrite",Xo:!0},function(A){var f=jn(A,m,"musicAlbumRelease");
A=jn(A,b,"musicAlbumReleaseDownloadMetadataEntity");return g.KU.all([f,A])}),2)}return Q.return(m)})},zMi=function(l,E){this.C=l;
this.G=E},w45=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q;
return g.P(function(A){switch(A.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,x=[],g.o1(A,2),g.I(A,rgB(l,C),4);case 4:x=A.C;if((Y=x)==null||!Y.length){A.jZ(5);break}return g.I(A,aI6(l.C,E.entityKey),5);case 5:g.sZ(A,3);break;case 2:return B=g.I1(A),q="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",O="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.MH&&B.type==="QUOTA_EXCEEDED"&&(q="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",O="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
A.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,q,O));case 3:return M=[],g.I(A,BGt(l.C,"musicTrack",x),7);case 7:x=A.C;if(x.length)for(v=g.U(x),N=v.next();!N.done;N=v.next())if(J=N.value,b=J.offlineVideoData,m=void 0,(m=b)==null?0:m.videoId)H=void 0,Q=Number(((H=E.actionMetadata)==null?void 0:H.priority)||0)+1,M.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",b.videoId,"musicTrack",Q,wi,a9(E,b,C)));return A.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,M))}})},
nax=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB,qh,a,gn,ki,dr,AH,y,EZ,sp,OK,$i,jR,eB,Cy,W9,t,K,V,R,c,tP,S,n,k,UZ,yx,uZ,Ou,G2,Qg,eO,oN,i_,a1,H_;
return g.P(function(PB){switch(PB.V){case 1:return e=OF(E),d=E.entityKey,C=g.z6(d).entityId,x=[],Y=!1,C==="!*$_ALL_ENTITIES_!*$"?(Y=!0,g.I(PB,nN(l.C,"musicPlaylist"),5)):g.I(PB,wZ(l.C,d,"musicPlaylist"),4);case 4:(B=PB.C)&&x.push(B);PB.jZ(3);break;case 5:x=PB.C;case 3:if((q=x)==null||!q.length)return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));O=g.T(E.actionMetadata,PSi);v=(M=O)==null?void 0:M.autoSync;N=[];b=J=!0;m=!1;H=void 0;if(!Y&&v===!1){PB.jZ(6);break}g.o1(PB,7);return g.I(PB,
$tt(0,!!v,!0,x),9);case 9:N=PB.C;g.sZ(PB,8);break;case 7:Q=g.I1(PB);if(!(Q instanceof Error&&Q.message==="No data")){Q instanceof Error&&Q.message==="Empty response body"&&Cz(Q.message);PB.jZ(8);break}return C==="!*$_ALL_ENTITIES_!*$"?g.I(PB,sF(l.C,E,l.G),8):g.I(PB,Qa(C,"musicPlaylist",l.C,E,l.G),8);case 8:if(!N.length||!Y&&N[0].playlistId!==C)return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));case 6:if(Y){A=[];f=g.U(N);for(h=f.next();!h.done;h=f.next())Z=h.value,Z.upToDate||
v&&!Z.shouldAutoSyncMetadata||!Z.playlistId||(r={autoSync:v},A.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",Z.playlistId,"musicPlaylist",0,wi,{musicPlaylistEntityActionMetadata:r})));return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,A))}N.length&&(X=N[0],m=!!X.upToDate,v&&(J=(qo=X.shouldAutoSyncMetadata)!=null?qo:!0,b=(BB=X.shouldAutoSyncVideos)!=null?BB:!0,X.checkInSeconds&&(H=X.checkInSeconds)));if(m||!J)return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e));OZ=[];No=x[0];eR=void 0;if(!No.downloadMetadata){PB.jZ(15);break}return g.I(PB,wZ(l.C,No.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:fs=PB.C,eR=Number((l_=(SR=fs)==null?void 0:SR.addedTimestampMillis)!=null?l_:"0")/1E3;case 15:return g.o1(PB,17),g.I(PB,rgB(l,C,(po=eR)==null?void 0:po.toString(),H),19);case 19:OZ=PB.C;g.sZ(PB,18);break;case 17:B6=g.I1(PB);if(!(B6 instanceof Error&&B6.message==="No data")){if(B6 instanceof Error&&B6.message==="Empty response body")Cz(B6.message);
else return R1="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B9="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B6 instanceof g.MH&&B6.type==="QUOTA_EXCEEDED"&&(R1="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",B9="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,R1,B9));PB.jZ(18);break}return g.I(PB,Qa(C,"musicPlaylist",l.C,E,l.G),18);case 18:if(!b)return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e));c6=[];jB=new Map;if((qh=OZ)==null?0:qh.length)for(a=g.U(OZ),gn=a.next();!gn.done;gn=a.next())ki=gn.value,dr=ki.offlineVideoData,AH=void 0,((AH=dr)==null?0:AH.videoId)&&jB.set(dr.videoId,dr);y=new Map;EZ=[];if((sp=No)==null?0:(OK=sp.tracks)==null?0:OK.length)for($i=g.U(No.tracks),jR=$i.next();!jR.done;jR=$i.next())if(eB=jR.value,Cy=g.z6(eB).entityId)jB.has(Cy)?(y.set(Cy,jB.get(Cy)),jB.delete(Cy)):EZ.push(Cy);t=Number(((W9=E.actionMetadata)==null?void 0:W9.priority)||0)+1;K=g.U(jB.entries());for(V=
K.next();!V.done;V=K.next())R=V.value,c=g.U(R),tP=c.next().value,S=c.next().value,n=tP,k=S,c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",n,"musicTrack",t,wi,a9(E,k)));UZ=g.U(y.entries());for(yx=UZ.next();!yx.done;yx=UZ.next())uZ=yx.value,Ou=g.U(uZ),G2=Ou.next().value,Qg=Ou.next().value,eO=G2,oN=Qg,c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",eO,"musicTrack",t,wi,a9(E,oN)));i_=g.U(EZ);for(a1=i_.next();!a1.done;a1=i_.next())H_=a1.value,c6.push(R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
H_,"musicTrack",0,wi));return PB.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,c6))}})},lpi=function(l,E){var e,d;
return g.P(function(C){switch(C.V){case 1:return e=OF(E),g.o1(C,2),d=g.z6(E.entityKey).entityId,d==="!*$_ALL_ENTITIES_!*$"?g.I(C,sF(l.C,E,l.G),5):g.I(C,Qa(d,"musicPlaylist",l.C,E,l.G),6);case 6:return g.I(C,IIK(l.C,E.entityKey),5);case 5:g.sZ(C,3);break;case 2:return g.I1(C),C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},rgB=function(l,E,e,d){var C,x,Y;
return g.P(function(B){switch(B.V){case 1:return g.I(B,hsu([E]),2);case 2:return C=B.C,g.I(B,EDx(l,C[0],e,d),3);case 3:return x=B.C,Y=pz(x.thumbnailDetails),g.I(B,t6(Y),4);case 4:return B.return(C[0].videos)}})},EDx=function(l,E,e,d){var C,x,Y,B,q,O,M,v,N;
return g.P(function(J){return J.V==1?(C=E.playlistId,x=fIo(E),Y=x.n6,B=x.Sa,q=e?(Number(e)*1E3).toString():Date.now().toString(),O=E.lastModifiedTimestamp?(Number(E.lastModifiedTimestamp)*1E3).toString():"0",M={id:g.rt(C,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:B,lastModifiedTimestampMillis:O,addedTimestampMillis:q,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},v={id:g.rt(C,"musicPlaylist"),title:E.title,playlistId:C,thumbnailDetails:E.thumbnail,visibility:eio(E),trackCount:E.totalVideoCount,
tracks:Y,downloadMetadata:M.id},d&&(((N=v)==null?0:N.entityMetadata)?v.entityMetadata.nextAutoRefreshIntervalSeconds=String(d):v&&(v.entityMetadata={nextAutoRefreshIntervalSeconds:String(d)})),g.I(J,zO(l.C,{mode:"readwrite",Xo:!0},function(b){var m=jn(b,v,"musicPlaylist");b=jn(b,M,"musicPlaylistDownloadMetadataEntity");return g.KU.all([m,b])}),2)):J.return(v)})},eio=function(l){switch(l.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},dVR=function(l,E){this.C=l;
this.G=E},uaB=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b;
return g.P(function(m){switch(m.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,x=g.T(E.actionMetadata,C0_),g.o1(m,2),g.I(m,xVH(l,C,void 0,(Y=x)==null?void 0:Y.track,(B=x)==null?void 0:B.albumRelease),4);case 4:if((q=x)==null?0:q.playlistId){m.jZ(5);break}return g.I(m,aI6(l.C,E.entityKey),5);case 5:g.sZ(m,3);break;case 2:return O=g.I1(m),M="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",O instanceof g.MH&&O.type==="QUOTA_EXCEEDED"&&
(M="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",v="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),m.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,M,v));case 3:J=Number(((N=E.actionMetadata)==null?void 0:N.priority)||0)+1;var H=(H=g.T(E.actionMetadata,C0_))?{playbackDataActionMetadata:{maximumDownloadQuality:H.maximumDownloadQuality}}:void 0;b=R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",C,"playbackData",J,Yx5,H);return m.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e,[b]))}})},Bg5=function(l,E){var e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H;
return g.P(function(Q){switch(Q.V){case 1:return e=OF(E),d=g.z6(E.entityKey),C=d.entityId,g.I(Q,wZ(l.C,E.entityKey,"musicTrack"),2);case 2:x=Q.C;if(!x){Y=void 0;Q.jZ(3);break}return g.I(Q,wZ(l.C,x.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:Y=Q.C;case 3:B=Y;if(!x||!B)return Q.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e));O=g.T(E.actionMetadata,C0_);g.o1(Q,5);return g.I(Q,xVH(l,C,B.addedTimestampMillis,(M=O)==null?void 0:M.track,(v=O)==null?void 0:v.albumRelease),
7);case 7:J=Number(((N=E.actionMetadata)==null?void 0:N.priority)||0)+1;q=R9("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",C,"playbackData",J,Yx5);g.sZ(Q,6);break;case 5:b=g.I1(Q);if(!(b instanceof Error&&b.message==="No data")){if(b instanceof Error&&b.message==="Empty response body")Cz(b.message);else return m="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",H="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",b instanceof g.MH&&b.type==="QUOTA_EXCEEDED"&&(m="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
H="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Q.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,m,H));Q.jZ(6);break}return g.I(Q,A6(C,l.C,E,l.G),6);case 6:return Q.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",e,q?[q]:void 0))}})},qxD=function(l,E){var e,d;
return g.P(function(C){switch(C.V){case 1:return e=OF(E),g.o1(C,2),d=g.z6(E.entityKey).entityId,d==="!*$_ALL_ENTITIES_!*$"?g.I(C,sF(l.C,E,l.G),5):g.I(C,A6(d,l.C,E,l.G),6);case 6:return g.I(C,IIK(l.C,E.entityKey),5);case 5:g.sZ(C,3);break;case 2:return g.I1(C),C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",e,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return C.return(new kf("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
e))}})},xVH=function(l,E,e,d,C){var x,Y,B,q,O,M;
return g.P(function(v){switch(v.V){case 1:if(x=d){v.jZ(2);break}return g.I(v,kvt([E]),3);case 3:Y=v.C,B=Y[0],x=sm_(B);case 2:return g.I(v,O_5(l,x,E,C,e),4);case 4:q=v.C;O=q.musicTrackEntity;M=q.z5;var N=pz(O.thumbnailDetails),J=[];M&&(J=pz(M.thumbnailDetails));return g.I(v,t6(N.concat(J)),0)}})},O_5=function(l,E,e,d,C){var x;
return g.P(function(Y){return Y.V==1?(C||(C=Date.now().toString()),x={id:g.rt(e,"musicTrackDownloadMetadataEntity"),playbackData:g.rt(e,"playbackData"),addedTimestampMillis:C,videoDownloadContextEntity:g.rt(e,"videoDownloadContextEntity")},d&&(E.albumRelease=d.id),g.I(Y,zO(l.C,{mode:"readwrite",Xo:!0},function(B){var q=[],O=jn(B,x,"musicTrackDownloadMetadataEntity");q.push(O);O=jn(B,E,"musicTrack");q.push(O);d&&(B=jn(B,d,"musicAlbumRelease"),q.push(B));return g.KU.all(q)}),2)):Y.V!=3?g.I(Y,J6(e,"musicTrackDownloadMetadataEntity",
l.C,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):Y.return({musicTrackEntity:E,
z5:d})})},nz=function(){GR.apply(this,arguments);
this.U="musicTrack"},MI_=function(l,E,e){E=E===void 0?43200:E;
e=e===void 0?!0:e;var d=d===void 0?!1:d;var C,x;return g.P(function(Y){switch(Y.V){case 1:if(!l.X.Gq())return Y.return([]);C=[];g.o1(Y,2);return g.I(Y,$tt(E,e,d),4);case 4:C=Y.C;g.sZ(Y,3);break;case 2:g.I1(Y);case 3:return x=p4H(l,C,e,"musicPlaylist"),Y.return(x)}})},vDx=function(){g.Vc.apply(this,arguments);
var l=this;this.events=new g.oE(this);this.Mw=this.player.N();this.qj={YfO:function(){return l.C},
ZP:function(){return l.ZP()},
wi:function(E){return l.wi(E)}}},Ngu=function(l){var E;
l=g.T((E=l.getWatchNextResponse())==null?void 0:E.currentVideoEndpoint,g.oR);if(l==null?0:l.playlistId)var e=l.playlistId;return e},JyW=function(l,E){var e,d,C,x;
return g.P(function(Y){if(Y.V==1){e=E.clientPlaybackNonce;d={cpn:e,offlineSourceVisualElement:g.bG(E.DQ||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};E.V&&(d.videoFmt=Number(E.V.itag));E.W&&(d.audioFmt=Number(E.W.itag));if((C=Ngu(E))&&E.videoId){var B=E.videoId;B=C!=="PPSV"?Promise.resolve(!1):l.C.r_(B);Y=g.I(Y,B,3)}else Y=Y.jZ(2);return Y}Y.V!=2&&(x=Y.C)&&(d.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");l.V=e;g.CU("offlinePlaybackStarted",d);g.Vg(Y)})};
g.jw.prototype.wv=g.Cs(45,function(l){return this.app.wv(l)});
g.p1.prototype.wv=g.Cs(44,function(l){return g.tiG(this,9,l)});
g.p(LN,FQ);g.xT.Object.defineProperties(LN.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.C.entityMetadata},
set:function(l){this.C.entityMetadata=l}}});
g.p(ddR,LN);ddR.prototype.V=function(){return[]};
g.p(CI6,LN);CI6.prototype.V=function(){return[]};
g.p(xdD,LN);xdD.prototype.V=function(){return[]};
g.p(Yst,LN);Yst.prototype.V=function(){return[]};
g.p(ud6,LN);ud6.prototype.V=function(){return[]};
g.p(BwN,LN);BwN.prototype.V=function(){var l=[];this.C.alternateChannel&&l.push(this.C.alternateChannel);this.C.alternateChannelList&&l.push.apply(l,g.bZ(this.C.alternateChannelList));this.C.oneofChannelEntity&&l.push(this.C.oneofChannelEntity);return[].concat(g.bZ(new Set(l)))};
g.p(qsB,LN);qsB.prototype.V=function(){var l=[];this.C.entryCollection&&l.push(this.C.entryCollection);return[].concat(g.bZ(new Set(l)))};
g.p(Ou5,FQ);Ou5.prototype.V=function(){var l=[];this.C.video&&l.push(this.C.video);return[].concat(g.bZ(new Set(l)))};
g.p(MrW,LN);MrW.prototype.V=function(){var l=[];this.C.parentPlaylist&&l.push(this.C.parentPlaylist);if(this.C.entries)for(var E=g.U(this.C.entries),e=E.next();!e.done;e=E.next())l.push.apply(l,g.bZ((new Ou5(e.value)).V()));return[].concat(g.bZ(new Set(l)))};
g.p(vl5,LN);vl5.prototype.V=function(){var l=[];this.C.descriptionEntity&&l.push(this.C.descriptionEntity);this.C.creators&&l.push.apply(l,g.bZ(this.C.creators));this.C.theBiggestFan&&l.push(this.C.theBiggestFan);return[].concat(g.bZ(new Set(l)))};
g.p(Nwx,LN);Nwx.prototype.V=function(){return[]};
g.p(JnR,LN);JnR.prototype.V=function(){return[]};
g.p(bux,LN);bux.prototype.V=function(){return[]};
g.p(DdR,LN);DdR.prototype.V=function(){return[]};
g.p(p5u,LN);p5u.prototype.V=function(){return[]};
g.p(Kt_,LN);Kt_.prototype.V=function(){return[]};
g.p(UdN,LN);UdN.prototype.V=function(){return[]};
g.p(mdu,LN);mdu.prototype.V=function(){return[]};
g.p(yn5,LN);yn5.prototype.V=function(){return[]};
g.p(trN,LN);trN.prototype.V=function(){var l=[];this.C.downloadsList&&l.push(this.C.downloadsList);this.C.smartDownloadsList&&l.push(this.C.smartDownloadsList);this.C.recommendedDownloadsList&&l.push(this.C.recommendedDownloadsList);this.C.refresh&&l.push(this.C.refresh);return[].concat(g.bZ(new Set(l)))};
g.p(HuK,FQ);HuK.prototype.V=function(){var l=[];this.C.video&&l.push(this.C.video);this.C.playlist&&l.push(this.C.playlist);this.C.videoItem&&l.push(this.C.videoItem);this.C.playlistItem&&l.push(this.C.playlistItem);return[].concat(g.bZ(new Set(l)))};
g.p(VrR,LN);VrR.prototype.V=function(){var l=[];this.C.refresh&&l.push(this.C.refresh);if(this.C.downloads)for(var E=g.U(this.C.downloads),e=E.next();!e.done;e=E.next())l.push.apply(l,g.bZ((new HuK(e.value)).V()));return[].concat(g.bZ(new Set(l)))};
g.p(olu,LN);olu.prototype.V=function(){var l=[];this.C.localImageEntities&&l.push.apply(l,g.bZ(this.C.localImageEntities));return[].concat(g.bZ(new Set(l)))};
g.p(Anx,LN);Anx.prototype.V=function(){var l=[];this.C.playbackData&&l.push(this.C.playbackData);this.C.localImageEntities&&l.push.apply(l,g.bZ(this.C.localImageEntities));this.C.videoDownloadContextEntity&&l.push(this.C.videoDownloadContextEntity);return[].concat(g.bZ(new Set(l)))};
g.p(Qbu,LN);Qbu.prototype.V=function(){return[]};
g.p(sb5,LN);sb5.prototype.V=function(){var l=[];this.C.fakeChildren&&l.push.apply(l,g.bZ(this.C.fakeChildren));return[].concat(g.bZ(new Set(l)))};
g.p(aBR,LN);aBR.prototype.V=function(){var l=[];this.C.video&&l.push(this.C.video);this.C.playbackData&&l.push(this.C.playbackData);this.C.offlineVideoPolicy&&l.push(this.C.offlineVideoPolicy);return[].concat(g.bZ(new Set(l)))};
g.p(IBW,LN);IBW.prototype.V=function(){return[]};
g.p(fBB,LN);fBB.prototype.V=function(){var l=[];this.C.channelOwner&&l.push(this.C.channelOwner);this.C.videos&&l.push.apply(l,g.bZ(this.C.videos));this.C.collaboratorChannels&&l.push.apply(l,g.bZ(this.C.collaboratorChannels));this.C.downloadState&&l.push(this.C.downloadState);this.C.refresh&&l.push(this.C.refresh);return[].concat(g.bZ(new Set(l)))};
g.p(PIN,LN);PIN.prototype.V=function(){var l=[];this.C.video&&l.push(this.C.video);this.C.channelContributor&&l.push(this.C.channelContributor);return[].concat(g.bZ(new Set(l)))};
g.p(RlH,FQ);RlH.prototype.V=function(){var l=[];this.C.localImageEntities&&l.push.apply(l,g.bZ(this.C.localImageEntities));this.C.videoDownloadContextEntity&&l.push(this.C.videoDownloadContextEntity);return[].concat(g.bZ(new Set(l)))};
g.p(k4i,FQ);k4i.prototype.V=function(){var l=[];this.C.recommendedVideoMetadata&&l.push.apply(l,g.bZ((new RlH(this.C.recommendedVideoMetadata)).V()));return[].concat(g.bZ(new Set(l)))};
g.p(hlH,FQ);hlH.prototype.V=function(){var l=[];this.C.playbackPosition&&l.push(this.C.playbackPosition);return[].concat(g.bZ(new Set(l)))};
g.p(FtD,LN);FtD.prototype.V=function(){var l=[];this.C.owner&&l.push(this.C.owner);this.C.downloadState&&l.push(this.C.downloadState);this.C.userState&&l.push.apply(l,g.bZ((new hlH(this.C.userState)).V()));this.C.additionalMetadata&&l.push.apply(l,g.bZ((new k4i(this.C.additionalMetadata)).V()));return[].concat(g.bZ(new Set(l)))};
g.p(Ltu,LN);Ltu.prototype.V=function(){var l=[];this.C.userChannelDetails&&l.push(this.C.userChannelDetails);return[].concat(g.bZ(new Set(l)))};
g.p(cni,LN);cni.prototype.V=function(){var l=[];this.C.channelOwner&&l.push(this.C.channelOwner);this.C.playbackPosition&&l.push(this.C.playbackPosition);this.C.localImageEntities&&l.push.apply(l,g.bZ(this.C.localImageEntities));this.C.downloadStatus&&l.push(this.C.downloadStatus);return[].concat(g.bZ(new Set(l)))};
g.p(iuK,LN);iuK.prototype.V=function(){return[]};
g.p(Zuo,LN);Zuo.prototype.V=function(){return[]};
g.p($di,LN);$di.prototype.V=function(){return[]};
g.p(TwW,LN);TwW.prototype.V=function(){return[]};
g.p(glD,LN);glD.prototype.V=function(){return[]};
g.p(Wt5,LN);Wt5.prototype.V=function(){return[]};
g.p(jbi,LN);jbi.prototype.V=function(){return[]};
g.p(G4R,LN);G4R.prototype.V=function(){return[]};
g.p(X5D,LN);X5D.prototype.V=function(){return[]};
g.p(Ss6,LN);Ss6.prototype.V=function(){return[]};
g.p(zl5,LN);zl5.prototype.V=function(){return[]};
g.p(rnu,LN);rnu.prototype.V=function(){return[]};
g.p(w5R,LN);w5R.prototype.V=function(){var l=[];this.C.trackDownloadMetadatas&&l.push.apply(l,g.bZ(this.C.trackDownloadMetadatas));return[].concat(g.bZ(new Set(l)))};
g.p(nlx,LN);
nlx.prototype.V=function(){var l=[];this.C.downloadedTracks&&l.push.apply(l,g.bZ(this.C.downloadedTracks));this.C.smartDownloadedTracks&&l.push.apply(l,g.bZ(this.C.smartDownloadedTracks));this.C.downloadedEpisodes&&l.push.apply(l,g.bZ(this.C.downloadedEpisodes));this.C.downloadedAlbumReleases&&l.push.apply(l,g.bZ(this.C.downloadedAlbumReleases));this.C.smartDownloadedAlbumReleases&&l.push.apply(l,g.bZ(this.C.smartDownloadedAlbumReleases));this.C.downloadedPlaylists&&l.push.apply(l,g.bZ(this.C.downloadedPlaylists));this.C.smartDownloadedPlaylists&&
l.push.apply(l,g.bZ(this.C.smartDownloadedPlaylists));this.C.metadataOnlyTracks&&l.push.apply(l,g.bZ(this.C.metadataOnlyTracks));return[].concat(g.bZ(new Set(l)))};
g.p(lMB,LN);lMB.prototype.V=function(){var l=[];this.C.trackDownloadMetadatas&&l.push.apply(l,g.bZ(this.C.trackDownloadMetadatas));return[].concat(g.bZ(new Set(l)))};
g.p(ErH,LN);ErH.prototype.V=function(){var l=[];this.C.playbackData&&l.push(this.C.playbackData);this.C.localImageEntities&&l.push.apply(l,g.bZ(this.C.localImageEntities));this.C.videoDownloadContextEntity&&l.push(this.C.videoDownloadContextEntity);return[].concat(g.bZ(new Set(l)))};
g.p(e5N,LN);e5N.prototype.V=function(){var l=[];this.C.musicLibraryStatusEntity&&l.push(this.C.musicLibraryStatusEntity);this.C.primaryArtists&&l.push.apply(l,g.bZ(this.C.primaryArtists));this.C.details&&l.push(this.C.details);this.C.userDetails&&l.push(this.C.userDetails);this.C.tracks&&l.push.apply(l,g.bZ(this.C.tracks));this.C.share&&l.push(this.C.share);this.C.downloadMetadata&&l.push(this.C.downloadMetadata);this.C.refresh&&l.push(this.C.refresh);return[].concat(g.bZ(new Set(l)))};
g.p(dwo,LN);dwo.prototype.V=function(){var l=[];this.C.albumRelease&&l.push(this.C.albumRelease);this.C.tracks&&l.push.apply(l,g.bZ(this.C.tracks));return[].concat(g.bZ(new Set(l)))};
g.p(CKB,LN);CKB.prototype.V=function(){var l=[];this.C.albumRelease&&l.push(this.C.albumRelease);return[].concat(g.bZ(new Set(l)))};
g.p(xwi,LN);xwi.prototype.V=function(){var l=[];this.C.details&&l.push(this.C.details);this.C.userDetails&&l.push(this.C.userDetails);return[].concat(g.bZ(new Set(l)))};
g.p(YQx,LN);YQx.prototype.V=function(){var l=[];this.C.parentArtist&&l.push(this.C.parentArtist);return[].concat(g.bZ(new Set(l)))};
g.p(ueN,LN);ueN.prototype.V=function(){var l=[];this.C.parentArtist&&l.push(this.C.parentArtist);return[].concat(g.bZ(new Set(l)))};
g.p(Bcx,LN);Bcx.prototype.V=function(){return[]};
g.p(qQx,LN);qQx.prototype.V=function(){return[]};
g.p(OkB,FQ);OkB.prototype.V=function(){var l=[];this.C.creatorEntity&&l.push(this.C.creatorEntity);return[].concat(g.bZ(new Set(l)))};
g.p(MxR,LN);
MxR.prototype.V=function(){var l=[];this.C.tracks&&l.push.apply(l,g.bZ(this.C.tracks));this.C.refresh&&l.push(this.C.refresh);this.C.musicLibraryStatusEntity&&l.push(this.C.musicLibraryStatusEntity);this.C.details&&l.push(this.C.details);this.C.downloadMetadata&&l.push(this.C.downloadMetadata);this.C.sideloadMetadata&&l.push(this.C.sideloadMetadata);this.C.userDetails&&l.push(this.C.userDetails);this.C.entryCollection&&l.push(this.C.entryCollection);this.C.share&&l.push(this.C.share);this.C.podcastShowAdditionalMetadata&&
l.push.apply(l,g.bZ((new OkB(this.C.podcastShowAdditionalMetadata)).V()));return[].concat(g.bZ(new Set(l)))};
g.p(vrR,LN);vrR.prototype.V=function(){return[]};
g.p(Nct,LN);
Nct.prototype.V=function(){var l=[];this.C.musicLibraryStatusEntity&&l.push(this.C.musicLibraryStatusEntity);this.C.artists&&l.push.apply(l,g.bZ(this.C.artists));this.C.audioModeVersion&&l.push(this.C.audioModeVersion);this.C.videoModeVersion&&l.push(this.C.videoModeVersion);this.C.userDetails&&l.push(this.C.userDetails);this.C.details&&l.push(this.C.details);this.C.albumRelease&&l.push(this.C.albumRelease);this.C.share&&l.push(this.C.share);this.C.libraryEdit&&l.push(this.C.libraryEdit);this.C.downloadMetadata&&
l.push(this.C.downloadMetadata);this.C.playbackPosition&&l.push(this.C.playbackPosition);this.C.lyrics&&l.push(this.C.lyrics);return[].concat(g.bZ(new Set(l)))};
g.p(JRx,LN);JRx.prototype.V=function(){var l=[];this.C.parentTrack&&l.push(this.C.parentTrack);return[].concat(g.bZ(new Set(l)))};
g.p(bkH,LN);bkH.prototype.V=function(){var l=[];this.C.parentTrack&&l.push(this.C.parentTrack);return[].concat(g.bZ(new Set(l)))};
g.p(DwB,LN);DwB.prototype.V=function(){return[]};
g.p(pDx,LN);pDx.prototype.V=function(){return[]};
g.p(KMu,LN);KMu.prototype.V=function(){return[]};
g.p(UwK,LN);UwK.prototype.V=function(){return[]};
g.p(mw5,LN);mw5.prototype.V=function(){var l=[];this.C.transfer&&l.push(this.C.transfer);this.C.adsPlaybackData&&l.push.apply(l,g.bZ(this.C.adsPlaybackData));this.C.drmLicense&&l.push(this.C.drmLicense);this.C.offlineVideoPolicy&&l.push(this.C.offlineVideoPolicy);this.C.videoDownloadContextEntity&&l.push(this.C.videoDownloadContextEntity);return[].concat(g.bZ(new Set(l)))};
g.p(yRx,LN);yRx.prototype.V=function(){return[]};
g.p(txx,LN);txx.prototype.V=function(){var l=[];this.C.offlineVideoStreams&&l.push.apply(l,g.bZ(this.C.offlineVideoStreams));this.C.captionTrack&&l.push.apply(l,g.bZ(this.C.captionTrack));return[].concat(g.bZ(new Set(l)))};
g.p(HkN,LN);HkN.prototype.V=function(){return[]};
g.p(VxK,LN);VxK.prototype.V=function(){return[]};
g.p(or5,LN);or5.prototype.V=function(){return[]};
g.p(ARt,LN);ARt.prototype.V=function(){return[]};
g.p(QFu,LN);QFu.prototype.V=function(){return[]};
g.p(sFt,LN);sFt.prototype.V=function(){return[]};
g.p(aMB,LN);aMB.prototype.V=function(){return[]};
g.p(IMi,LN);IMi.prototype.V=function(){return[]};
g.p(fMx,LN);fMx.prototype.V=function(){return[]};
g.p(PKi,LN);PKi.prototype.V=function(){return[]};
g.p(R5x,LN);R5x.prototype.V=function(){return[]};
g.p(kMt,LN);kMt.prototype.V=function(){return[]};
g.p(h5x,LN);h5x.prototype.V=function(){return[]};
g.p(FMu,LN);FMu.prototype.V=function(){return[]};
g.p(LMu,LN);LMu.prototype.V=function(){return[]};
g.p(cRK,LN);cRK.prototype.V=function(){return[]};
g.p(ik6,LN);ik6.prototype.V=function(){return[]};
g.p(ZkK,LN);ZkK.prototype.V=function(){return[]};
g.p($wx,LN);$wx.prototype.V=function(){return[]};
g.p(TcH,LN);TcH.prototype.V=function(){return[]};
g.p(grN,LN);grN.prototype.V=function(){return[]};
var TGD=["browse","music/browse","unplugged/browse"],Xvt=["offline/playlist_sync_check"],Rs_=["offline"],g2x=["offline/offline_video_playback_position_sync"],jmD=["offline/get_playback_data_entity"],cP;id.getInstance=function(){return g.P(function(l){return l.return(new Promise(function(E){g.Xb().then(function(e){e?(id.instance||(id.instance=new id(e)),E(id.instance)):E(void 0)})}))})};
id.prototype.get=function(l){var E=this,e,d,C;return g.P(function(x){if(x.V==1)return g.I(x,XDW(E.token),2);if(x.V!=3)return e=x.C,g.I(x,e.get("prefs",l),3);d=x.C;if(!d)return x.return();C=(0,g.tF)();return d.expirationTimestampMs<=C?x.return():x.return(d.value)})};
id.prototype.set=function(l,E,e){e=e===void 0?31536E3:e;var d=this,C,x,Y;return g.P(function(B){if(B.V==1)return C=(0,g.tF)(),x={key:l,value:E,expirationTimestampMs:C+e*1E3},g.I(B,XDW(d.token),2);Y=B.C;return g.I(B,g.aw(Y,"prefs",x),0)})};
id.prototype.remove=function(l){var E=this,e;return g.P(function(d){if(d.V==1)return g.I(d,XDW(E.token),2);e=d.C;return g.I(d,e.delete("prefs",l),0)})};
g.p(Zk,g.$C);g.p($E,nrN);$E.prototype.G=function(l,E){E=E0D(E);l=(new TextEncoder).encode(JSON.stringify(l));return this.C.encrypt(l,E)};
$E.prototype.V=function(l,E){if(!(l instanceof Uint8Array))throw SQt(1);var e=new TextDecoder;E=E0D(E);l=this.C.decrypt(l,E);return JSON.parse(e.decode(l))};
var eNo={accountLinkStatusEntity:bux,booleanEntity:Yst,buttonEntity:FMu,captionTrack:DwB,channelHandle:ddR,chipEntity:aMB,commerceAcquisitionClientPayloadEntity:cRK,commerceCartListEntity:ik6,contextNoteFeedEntityPayload:CI6,contextNoteUserRatingEntityPayload:xdD,continuationTokenEntity:IBW,downloadQualityPickerEntity:UdN,downloadsPageRefreshTokenEntity:yn5,downloadsPageViewConfigurationEntity:iuK,downloadStatusEntity:mdu,dismissState:IMi,sfvAudioItemCurrentlyPlayingEntity:ARt,emojiFountainDataEntity:kMt,
emojiCustomizationSetEntity:R5x,fakeChannel:BwN,fakePlaylist:qsB,fakePlaylistEntryCollection:MrW,fakeVideo:vl5,fakeVideoDescription:Nwx,featuredProductsEntity:Ss6,flowStateEntity:JnR,iconBadgeEntity:ZkK,interstitialInteractionStateEntity:p5u,likeButtonAnimationEntity:Zuo,liveChatPollStateEntity:Kt_,liveViewerLeaderboardChatEntryPointStateEntity:VxK,liveViewerLeaderboardPointsEntity:or5,liveReactionsDataEntity:h5x,logoEntity:DdR,macroMarkerEntity:$di,mainDownloadsLibraryEntity:trN,mainDownloadsListEntity:VrR,
mainPlaylistDownloadStateEntity:olu,mainPlaylistEntity:fBB,mainPlaylistVideoEntity:PIN,mainVideoDownloadStateEntity:Anx,mainVideoEntity:FtD,markersEngagementPanelSyncEntity:TwW,markersVisibilityOverrideEntity:glD,musicAlbumReleaseDetail:dwo,musicAlbumReleaseDownloadMetadataEntity:w5R,musicAlbumRelease:e5N,musicAlbumReleaseUserDetail:CKB,musicArtistDetail:YQx,musicArtist:xwi,musicArtistUserDetail:ueN,musicDownloadsLibraryEntity:nlx,musicLibraryEdit:Bcx,musicLibraryStatusEntity:qQx,musicPlaylist:MxR,
musicPlaylistDownloadMetadataEntity:lMB,musicShare:vrR,musicTrackDetail:JRx,musicTrackDownloadMetadataEntity:ErH,musicTrack:Nct,musicTrackUserDetail:bkH,offlineOrchestrationActionWrapperEntity:pDx,offlineVideoPolicy:KMu,offlineVideoStreams:UwK,offlineabilityEntity:Qbu,orchestrationWebSamplingEntity:sb5,pageHeaderEntity:fMx,pdpStateEntity:$wx,pinnedProductEntity:zl5,playbackData:mw5,playerStateEntity:Wt5,quantityIncrementerEntity:TcH,refresh:yRx,saveToPlaylistListEntity:QFu,selectedChipIndexEntityPayload:jbi,
settingEntity:sFt,stringEntity:ud6,suggestedFeedbackChipStateEntity:G4R,transfer:txx,trendingOfferEntity:rnu,videoDownloadContextEntity:HkN,videoOverviewAsyncDataEntity:grN,videoPlaybackPositionEntity:LMu,votingEntity:PKi,ytMainChannelEntity:Ltu,youchatPendingResponseEntity:X5D,ytMainDownloadedVideoEntity:aBR,ytMainVideoEntity:cni};g.p(XQ,nrN);XQ.prototype.G=function(l){return l};
XQ.prototype.V=function(l){if(l instanceof Uint8Array)throw SQt(0);return l};
g.p(Sn,g.F);Sn.prototype.observe=function(l){var E=this;this.observers.push(l);return function(){var e=E.observers.indexOf(l);e>=0&&E.observers.splice(e,1)}};
Sn.prototype.V=function(l){D05(this,l.data)};
Sn.prototype.cS=function(){this.channel.close()};
var y0D,Utt=new g.tg("elementsCommand");var Va=new g.tg("entityBatchUpdate");var u7o=new g.tg("downloadStatusEntity");var Hrx=new g.tg("mainPlaylistEntityActionMetadata");var zR=new g.tg("mainVideoEntityActionMetadata");var PSi=new g.tg("musicPlaylistEntityActionMetadata");var C0_=new g.tg("musicTrackEntityActionMetadata");var cgD=new g.tg("localImageEntityActionMetadata");var h6=new g.tg("playbackDataActionMetadata");var mEu=new g.tg("transferEntityActionMetadata");var xEu=new g.tg("videoPlaybackPositionEntityActionMetadata");var F4K;new g.N0;new g.N0;$0K.prototype.request=function(l,E,e){E=E===void 0?{}:E;return this.locks.request(l,E,function(d){return e(d)})};var di=g.wr.caches,ej,Glo;EF.prototype.open=function(l){return di.open(W4B(l))};
EF.prototype.has=function(l){return di.has(W4B(l))};
EF.prototype.delete=function(l){return di.delete(W4B(l))};
EF.prototype.match=function(l,E){var e=this,d,C,x,Y,B,q;return g.P(function(O){switch(O.V){case 1:return g.I(O,e.keys(),2);case 2:d=O.C,C=g.U(d),x=C.next();case 3:if(x.done){O.jZ(5);break}Y=x.value;return g.I(O,e.open(Y),6);case 6:return B=O.C,g.I(O,B.match(l,E),7);case 7:if(q=O.C)return O.return(q);x=C.next();O.jZ(3);break;case 5:return O.return()}})};
g.p(g0D,EF);g0D.prototype.keys=function(){var l,E,e,d,C,x,Y,B,q;return g.P(function(O){if(O.V==1)return l=[],E=g.TZ("CacheStorage keys"),g.I(O,di.keys(),2);e=O.C;d=g.U(e);for(C=d.next();!C.done;C=d.next()){x=C.value;var M=x.indexOf(":");Y=M===-1?{Vl:x}:{Vl:x.substring(0,M),datasyncId:x.substring(M+1)};B=Y.Vl;q=Y.datasyncId;q===E&&l.push(B)}return O.return(l)})};g.p(xf,g.F);xf.prototype.G=function(l){this.api.x8("onOfflineOperationFailure",l.data)};
xf.prototype.W=function(l){this.api.publish("offlinetransferpause",l.data)};
xf.prototype.cS=function(){var l;(l=this.C)==null||l.close();var E;(E=this.V)==null||E.close()};zNK.prototype.N7=function(){this.C&&u6(this)};
zNK.prototype.b7=function(){this.V&&this.V.resolve();this.G=this.C=!1;this.U()};var FP6=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var DtN="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var Qmt="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.p(zsx,Pm);zsx.prototype.V=function(l){return Mb(l)?n2u(this,l):vm(l)?eJD(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};g.p(dEi,Pm);dEi.prototype.V=function(l){return vm(l)?C9_(this,l):Ynt(l)?Ydu(this,l):Nb(l)?uW5(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};g.D=B4B.prototype;g.D.Ag4=function(l){var E=this,e,d,C,x;return g.P(function(Y){if(!g.G(l.state,128))return Y.jZ(0);e=l.state.m6;var B=(d=e)==null?void 0:d.errorCode,q=(C=e)==null?void 0:C.Yx;x=B==="net.connect"&&q===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(B==null?0:B.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.I(Y,E.dJ(E.player.getVideoData().videoId,x),0)})};
g.D.dJ=function(l,E){var e=this;return g.P(function(d){if(d.V==1){if(e.V)return d.return();e.V=!0;return E==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(cm(e,l,!1,!0),d.jZ(0)):g.I(d,Lz(e,l),3)}g.YX(l,4);return g.I(d,e.C.dJ(E),0)})};
g.D.Qf=function(l){l.status===2?(l.status!==this.G&&(C7t(this.C),g.YX(l.videoId,2)),l.oN&&qBH(this.C,l.videoId,l.oN)):l.status===4?(Lz(this,l.videoId),this.dJ(l.videoId,l.tW?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):l.status===1&&B6D(this.C);this.G=l.status;this.api.x8("localmediachange",{videoId:l.videoId,status:l.status})};
g.D.Xn=function(){var l=this,E;return g.P(function(e){if(e.V==1){if(l.V)return e.return();l.V=!0;E=l.player.getVideoData().videoId;return g.I(e,Lz(l,E),2)}return g.I(e,l.C.Xn(),0)})};
g.D.q3=function(l){switch(l){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.D.B=function(l){return this.api.N().B(l)};g.p(bZu,Pm);bZu.prototype.V=function(l){return Mb(l)?pNo(this,l):vm(l)?KPu(this,l):Ynt(l)?UEu(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};oPx.prototype.C=function(l,E){var e=l.action.actionMetadata.priority-E.action.actionMetadata.priority;e===0&&(l.C<E.C?e=-1:l.C>E.C&&(e=1));return e};g.p(i6,g.F);i6.prototype.cS=function(){this.U&&this.U();g.F.prototype.cS.call(this)};
i6.prototype.createAction=function(l,E){var e=g.z6(l.entityKey).entityType,d=g.bT(16);return new Kz(e,d,l,E.actionId,E.rootActionId)};
i6.prototype.VV=function(l){var E=this,e,d,C,x,Y,B,q,O,M;return g.P(function(v){if(v.V==1){if(E.BS())return v.return();d=(e=l.offlineOrchestrationActionWrapperEntity)!=null?e:new Set;C=[];x=g.U(d);for(Y=x.next();!Y.done;Y=x.next())B=Y.value,q=g.z6(B),O=q.entityId,sdH(E.C,O)||C.push(B);return g.I(v,iZ_(E,C),2)}M=v.C;return g.I(v,cBW(E,M),0)})};
i6.prototype.retry=function(){var l=this;return g.P(function(E){return g.I(E,ZZ5(l),0)})};T4i.prototype.dk=function(l,E){E=E===void 0?!0:E;var e=this,d,C,x,Y,B,q,O,M;return g.P(function(v){switch(v.V){case 1:if(!e.C)return v.return();d=[];C=g.CX(e.C.V,E);x=[];for(Y={iD:0};Y.iD<C.length;Y={iD:Y.iD},Y.iD++)B=C[Y.iD],q=e.C.gh(B,"json3"),O=g.ox(q,{withCredentials:!0,format:"RAW"},3,500).then(function(N){return function(J){J={metadata:g.WI(C[N.iD]),trackData:J.xhr.responseText};x.push(J)}}(Y)).bZ(function(N){Cz("Caption fetch error",N)}),d.push(O);
return g.I(v,elx(d),2);case 2:return g.o1(v,3),g.I(v,as6(l,x),5);case 5:g.sZ(v,0);break;case 3:M=g.I1(v),Cz("Caption DB transaction error",M),g.Vg(v)}})};g.p(Zr,g.F);Zr.prototype.cS=function(){this.V&&this.V();g.F.prototype.cS.call(this)};
Zr.prototype.G=function(l){var E=this,e,d,C,x,Y,B,q,O;return g.P(function(M){d=(e=l.transfer)!=null?e:new Set;C=[];x=g.U(d);for(Y=x.next();!Y.done;Y=x.next())B=Y.value,q=g.z6(B),O=q.entityId,C.push(O);return C.length===0?M.return():g.I(M,jd_(E,C),0)})};g.p(rB5,g.F);g.D=rB5.prototype;g.D.cS=function(){this.vS&&this.vS();this.pJ.dispose();this.W.dispose();this.DQ&&g.ww(this.X.IF,this.DQ);this.s6&&g.ww(this.X.IF,this.s6);g.F.prototype.cS.call(this)};
g.D.QcK=function(l){var E=this,e,d,C;return g.P(function(x){switch(x.V){case 1:e=g.rt(l,"transfer");if(E.C&&e===E.C.key){cm(E.Y,E.Z,!0);E.W.stop();x.jZ(0);break}return g.I(x,zO(E.V,{mode:"readwrite",Xo:!0},function(Y){return TO(Y,e,"transfer").then(function(B){if(B&&B.transferState!=="TRANSFER_STATE_COMPLETE"&&B.transferState!=="TRANSFER_STATE_FAILED")return B.transferState="TRANSFER_STATE_PAUSED_BY_USER",jn(Y,B,"transfer").then(function(){return B})})}),3);
case 3:d=x.C;if(!d){x.jZ(0);break}if(!l||!E.G){x.jZ(5);break}return g.I(x,J6(l,E.G,E.V,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.I(x,gi(E,l),7);case 7:C=x.C,CSx({videoId:l,fq:d,offlineModeType:C}),g.Vg(x)}})};
g.D.n0O=function(){var l=this;if(this.C&&this.Z){cm(this.Y,this.Z,!1);var E=this.C,e=(E==null?0:E.key)?g.z6(E.key).entityId:"";e&&this.G&&(new Promise(function(d,C){J6(e,l.G,l.V,"DOWNLOAD_STATE_PAUSED").catch(function(x){C(x)})})).catch(function(d){Cz("Download state setting error",d)})}this.W.stop()};
g.D.LY=function(){this.C?li6(this,this.C):TR(this)};
g.D.P3=function(l){var E=this;return g.P(function(e){switch(e.V){case 1:if(!E.C){e.jZ(2);break}if(E.C.transferState==="TRANSFER_STATE_COMPLETE"||E.C.transferState==="TRANSFER_STATE_FAILED"||!l.transfer||!l.transfer.has(E.C.key)){e.jZ(3);break}return g.I(e,wZ(E.V,E.C.key,"transfer"),4);case 4:E.C=e.C;if(E.C){e.jZ(3);break}return g.I(e,Eao(E),3);case 3:if(E.C)return e.return();case 2:return g.I(e,TR(E),0)}})};
g.D.dJ=function(l,E){var e=this,d,C,x,Y,B;return g.P(function(q){switch(q.V){case 1:if(!e.C){Wm(e,"onTransferFailure: "+l);q.jZ(2);break}d=e.C;x=((C=d)==null?0:C.key)?g.z6(d.key).entityId:"";a:switch(l){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var O=!1;break a;default:O=!0}return O&&Or_(e)?g.I(q,jj(e,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.I(q,
MVD(e,l),5);case 5:if(!x||!e.G){q.jZ(2);break}return g.I(q,J6(x,e.G,e.V,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.I(q,gi(e,x),9);case 9:Y=q.C;qb({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:x,fq:d,offlineModeType:Y});if(!x||!e.G){q.jZ(2);break}return g.I(q,J6(x,e.G,e.V,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:$f(e),B=TR(e,!0),E&&E(B),g.Vg(q)}})};
g.D.Xn=function(l){var E=this,e,d,C,x,Y,B,q,O,M,v,N,J;return g.P(function(b){switch(b.V){case 1:if(!E.C){Wm(E,"onMaybeTransferStreamsExpired");b.jZ(2);break}return Or_(E)?g.I(b,jj(E,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.I(b,MVD(E,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!E.G){b.jZ(2);break}e=E.C;C=((d=e)==null?0:d.key)?g.z6(e.key).entityId:"";if(!C){b.jZ(2);break}return g.I(b,J6(C,E.G,E.V,"DOWNLOAD_STATE_FAILED"),2);case 9:return E.C||Wm(E,"onMaybeTransferStreamsExpiredRetryAttempting"),
x=E.C,B=((Y=x)==null?0:Y.key)?g.z6(x.key).entityId:"",g.I(b,gi(E,B),10);case 10:return q=b.C,qb({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:B,fq:x,offlineModeType:q}),O=OAx(),g.P2(O,h6,{isEnqueuedForExpiredStreamUrlRefetch:!0}),M=g.rt(B,"playbackData"),v={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:M,actionMetadata:O},N=mw(new Kz("playbackData",B,v)),g.I(b,rZ(E.V,N,"offlineOrchestrationActionWrapperEntity"),2);case 2:$f(E),J=TR(E,!0),
l&&l(J),g.Vg(b)}})};
var b_N={},vai=(b_N.TRANSFER_STATE_TRANSFERRING=1,b_N.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,b_N);g.D=GR.prototype;g.D.oQ=function(){return this.Z.promise};
g.D.Zp=function(){if(this.V&&this.Y)return this.Z.promise;brt(this).then(this.Z.resolve).catch(this.Z.reject);return this.Z.promise};
g.D.IM=function(l){var E={};return E.playbackData=new zsx(l,this.Mw,this.C),E.transfer=new bZu(l,this.Mw),E.videoPlaybackPositionEntity=new dEi(l,this.Mw),E};
g.D.fz=function(){var l=this;return g.P(function(E){return l.V?g.I(E,wNi(l.V),0):E.jZ(0)})};
g.D.hf=function(){var l=this,E,e;return g.P(function(d){if(d.V==1)return l.V||l.Y?g.I(d,l.oQ(),2):d.return();l.K!==void 0&&(g.Jy(l.K),l.K=void 0);l.W!==void 0&&(g.Jy(l.W),l.W=void 0);(E=l.V)==null||E.dispose();l.V=void 0;(e=l.Y)==null||e.dispose();l.Y=void 0;l.api.x8("onOrchestrationLostLeader");l.Z=new g.N0;g.Vg(d)})};
g.D.isOrchestrationLeader=function(){return this.G.C};
g.D.r_=function(){return g.P(function(l){return l.return(!1)})};
g.D.Fn=function(l){var E=this.C;E.api.publish("offlinetransferpause",l);var e;(e=E.V)==null||e.postMessage(l)};
g.D.LY=function(l){var E,e;return g.P(function(d){if(d.V==1)return g.I(d,l6(),2);E=d.C;if(!E)return d.return();e=g.rt(l,"transfer");return g.I(d,zO(E,{mode:"readwrite",Xo:!0},function(C){var x=TO(C,e,"transfer"),Y=TO(C,g.rt(l,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.KU.all([x,Y]).then(function(B){B=g.U(B);var q=B.next().value;var O=B.next().value;return q&&q.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(q.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",jn(C,q,"transfer").then(function(){qb({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:l,fq:q,offlineModeType:O==null?void 0:O.offlineModeType});return g.KU.resolve(null)})):g.KU.resolve(null)})}),0)})};
g.D.gY=function(l){l=l===void 0?43200:l;var E=this,e,d,C,x,Y,B,q,O;return g.P(function(M){if(M.V==1)return E.X.Gq()?g.I(M,l6(),2):M.return(DeK());if(M.V!=3){e=M.C;if(!e)return M.return([]);d=Date.now()/1E3;return g.I(M,nN(e,"offlineVideoPolicy"),3)}C=M.C;x=[];Y=g.U(C);for(B=Y.next();!B.done;B=Y.next())q=B.value,Number(q.lastUpdatedTimestampSeconds)+l<=d&&(O=g.z6(q.key).entityId,x.push(O));return x.length?M.return(XO(E,x,E.U,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):M.return([])})};
g.D.deleteAll=function(){return XO(this,["!*$_ALL_ENTITIES_!*$"],this.U,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.D.refreshAllStaleEntities=function(l){var E=this;return g.P(function(e){return e.V==1?g.I(e,E.gY(l),2):e.return(e.C)})};
g.D.setUpPositionSyncInterval=function(l){var E=this;this.W!==void 0&&(g.Jy(this.W),this.W=void 0);var e=l!=null?l:864E5;this.W=g.vn(function(){E.Tc(e)},e)};
g.D.Tc=function(l){var E=this,e,d,C,x,Y,B;return g.P(function(q){switch(q.V){case 1:return g.o1(q,2),g.I(q,id.getInstance(),4);case 4:e=q.C;if(!e)throw Error("prefStorage is undefined");return g.I(q,e.get("psi"),5);case 5:d=q.C;x=((C=d)==null?0:C.Zk)?Number(d.Zk)/1E3:0;Y=Date.now();if(!(x+l<=Y)){q.jZ(6);break}return g.I(q,XO(E,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.sZ(q,0);break;case 2:B=g.I1(q),Cz("Offline manager error",B),
g.Vg(q)}})};
g.D.Lz=function(){var l=this,E,e,d,C,x,Y,B;return g.P(function(q){if(q.V==1)return g.I(q,l6(),2);if(q.V!=3)return(E=q.C)?g.I(q,nN(E,"transfer"),3):q.return([]);e=q.C;d=[];C=g.U(e);for(x=C.next();!x.done;x=C.next())Y=x.value,Y.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&Y.key&&(B=g.z6(Y.key).entityId,d.push(B));return q.return(KQi(l,d))})};
g.D.f7=function(){return g.P(function(l){return l.return([])})};
g.D.QD=function(){return g.P(function(l){g.Vg(l)})};
g.D.oD=function(){return g.P(function(l){g.Vg(l)})};g.p(Uex,Pm);Uex.prototype.V=function(l){return Mb(l)?tVt(this,l):vm(l)?VVD(this,l):Nb(l)?oao(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};
var Sj=[10];g.p(IiK,Pm);IiK.prototype.V=function(l){return Mb(l)?RMK(this,l):vm(l)?kA5(this,l):Nb(l)?hMW(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};
var P7u=[10];g.p(LQi,Pm);LQi.prototype.V=function(l){return vm(l)?irB(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};g.p(ZrR,GR);g.D=ZrR.prototype;g.D.IM=function(l){var E=GR.prototype.IM.call(this,l);E.mainVideoEntity=new IiK(l,this.Mw,this.C);E.mainPlaylistEntity=new Uex(l,this.Mw,this.C);E.mainDownloadsListEntity=new LQi(l,this.Mw,this.C);return E};
g.D.refreshAllStaleEntities=function(l,E){var e=this,d,C,x,Y,B,q,O,M,v,N,J;return g.P(function(b){switch(b.V){case 1:d=[];if(!e.Mw.B("web_player_offline_playlist_auto_refresh")){b.jZ(2);break}return g.I(b,$eB(e,l,E),3);case 3:d=b.C;case 2:return g.I(b,id.getInstance(),4);case 4:return C=b.C,g.I(b,(x=C)==null?void 0:x.get("sdois"),5);case 5:return Y=b.C,g.I(b,(B=C)==null?void 0:B.get("lmqf"),6);case 6:q=b.C;if(!Y){b.jZ(7);break}M=d;v=M.concat;return g.I(b,T6x(e,Y,(O=q)!=null?O:"SD",l===0),8);case 8:d=
v.call(M,b.C);case 7:return N=d,J=N.concat,g.I(b,GR.prototype.refreshAllStaleEntities.call(e,l,E),9);case 9:return d=J.call(N,b.C),b.return(d)}})};
g.D.r_=function(l){var E,e,d,C,x,Y,B,q;return g.P(function(O){if(O.V==1)return g.I(O,l6(),2);if(O.V!=3)return(E=O.C)?g.I(O,wZ(E,g.Lb,"mainDownloadsListEntity"),3):O.return(!1);e=O.C;if((d=e)==null?0:(C=d.downloads)==null?0:C.length)for(x=g.rt(l,"mainVideoEntity"),Y=g.U(e.downloads),B=Y.next();!B.done;B=Y.next())if(q=B.value,q.videoItem===x)return O.return(!0);return O.return(!1)})};
g.D.f7=function(){var l=this,E,e,d,C,x,Y,B,q;return g.P(function(O){if(O.V==1)return g.I(O,l6(),2);if(O.V!=3)return(E=O.C)?g.I(O,nN(E,"downloadStatusEntity"),3):O.return([]);e=O.C;d=[];C=g.U(e);for(x=C.next();!x.done;x=C.next())Y=x.value,Y.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&Y.key&&(B=g.z6(Y.key).entityId,d.push(B));return d.length?(q={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},O.return(XO(l,d,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
q))):O.return([])})};
g.D.oD=function(){var l;return g.P(function(E){return E.V==1?g.I(E,l6(),2):(l=E.C)?g.I(E,zO(l,{mode:"readwrite",Xo:!0},function(e){return gZ(e,"mainVideoEntity").then(function(d){var C=[];d=g.U(d);for(var x=d.next();!x.done;x=d.next()){x=x.value;var Y=void 0;(Y=x.userState)!=null&&Y.playbackPosition||(Y=g.z6(x.key).entityId,Y={key:g.rt(Y,"videoPlaybackPositionEntity"),videoId:Y,lastPlaybackPositionSeconds:"0"},C.push(jn(e,Y,"videoPlaybackPositionEntity")),x.userState={playbackPosition:Y.key},C.push(jn(e,
x,"mainVideoEntity")))}return g.KU.all(C)})}),0):E.return()})};
g.D.QD=function(){var l,E,e,d,C,x,Y,B,q,O,M,v,N,J,b,m,H,Q,A,f,h,Z,r,X,qo,BB,OZ,No,eR,fs,SR,l_,po,B6,R1,B9,c6,jB;return g.P(function(qh){if(qh.V==1)return g.I(qh,l6(),2);if(qh.V!=3){l=qh.C;if(!l)return qh.return();E=g.rt("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.I(qh,zO(l,{mode:"readonly",Xo:!0},function(a){return g.KU.all([TO(a,E,"mainDownloadsListEntity"),TO(a,g.Lb,"mainDownloadsListEntity"),gZ(a,"mainVideoEntity"),gZ(a,"mainPlaylistEntity")])}),3)}e=qh.C;
d=g.U(e);C=d.next().value;x=d.next().value;Y=d.next().value;B=d.next().value;q=C;O=x;M=Y;v=B;N=new Set;if((J=q)==null?0:(b=J.downloads)==null?0:b.length)for(m=g.U(q.downloads),H=m.next();!H.done;H=m.next())Q=H.value,A=void 0,(f=(A=Q.videoItem)!=null?A:Q.playlistItem)&&N.add(f);if((h=O)==null?0:(Z=h.downloads)==null?0:Z.length)for(r=g.U(O.downloads),X=r.next();!X.done;X=r.next())qo=X.value,qo.videoItem&&N.add(qo.videoItem);BB=new Set;OZ=[];No=g.U(v);for(eR=No.next();!eR.done;eR=No.next()){fs=eR.value;
if(fs.videos)for(SR=g.U(fs.videos),l_=SR.next();!l_.done;l_=SR.next())po=l_.value,(B6=JSON.parse(g.z6(po).entityId).videoId)&&BB.add(B6);fs.key&&!N.has(fs.key)&&OZ.push(fs.key)}R1=g.U(M);for(B9=R1.next();!B9.done;B9=R1.next())c6=B9.value,c6.key&&!N.has(c6.key)&&(jB=g.z6(c6.key).entityId,BB.has(jB)||OZ.push(c6.key));return OZ.length?g.I(qh,HAo(l,OZ),0):qh.jZ(0)})};g.p(gai,Pm);gai.prototype.V=function(l){return Mb(l)?j5W(this,l):vm(l)?GAR(this,l):Nb(l)?X46(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};
var ri=[10];g.p(zMi,Pm);zMi.prototype.V=function(l){return Mb(l)?w45(this,l):vm(l)?nax(this,l):Nb(l)?lpi(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};
var wi=[10];g.p(dVR,Pm);dVR.prototype.V=function(l){return Mb(l)?uaB(this,l):vm(l)?Bg5(this,l):Nb(l)?qxD(this,l):Promise.reject(Error("Unsupported action type: "+l.actionType))};
var Yx5=[10];g.p(nz,GR);nz.prototype.IM=function(l){var E=GR.prototype.IM.call(this,l);E.musicTrack=new dVR(l,this.C);E.musicPlaylist=new zMi(l,this.C);E.musicAlbumRelease=new gai(l,this.C);return E};
nz.prototype.refreshAllStaleEntities=function(l,E){var e=this,d,C,x;return g.P(function(Y){if(Y.V==1)return g.I(Y,MI_(e,l,E),2);if(Y.V!=3)return C=d=Y.C,x=C.concat,g.I(Y,GR.prototype.refreshAllStaleEntities.call(e,l,E),3);d=x.call(C,Y.C);return Y.return(d)})};g.p(vDx,g.Vc);g.D=vDx.prototype;g.D.create=function(){var l=this;g.L(this,this.events);if(g.Vr(this.Mw))this.C=new ZrR(this.Mw,this.player);else if(g.Rn(this.Mw)||g.AS(this.Mw))this.C=new nz(this.Mw,this.player);this.events.L(this.player,"onPlaybackStartExternal",function(){l.ZP()});
this.events.L(this.player,"videodatachange",function(){l.ZP()});
this.Mw.B("html5_offline_playback_position_sync")&&this.events.L(this.player,"presentingplayerstatechange",this.wi)};
g.D.NW=function(){return!1};
g.D.Z$=function(l,E,e,d){var C=this;return g.P(function(x){return C.C?x.return(XO(C.C,l,E,e,d)):x.return(Promise.reject())})};
g.D.deleteAll=function(){return this.C.deleteAll()};
g.D.gY=function(l){return this.C.gY(l)};
g.D.refreshAllStaleEntities=function(l){return this.C.refreshAllStaleEntities(l)};
g.D.setUpPositionSyncInterval=function(l){this.C.setUpPositionSyncInterval(l)};
g.D.Fn=function(l){this.C.Fn(l)};
g.D.LY=function(l){return this.C.LY(l)};
g.D.ZP=function(){var l=this,E;return g.P(function(e){E=l.player.getVideoData();return g.UO(E)?Ngu(E)&&l.V!==E.clientPlaybackNonce?g.I(e,JyW(l,E),0):e.jZ(0):e.return()})};
g.D.wi=function(l){var E=this,e,d,C,x,Y,B,q;return g.P(function(O){if(O.V==1)return e=E.player.getVideoData(),d=e.DX,g.MZ(l,2)||g.MZ(l,512)?g.I(O,l6(),2):O.return();if(O.V!=3){C=O.C;if(!C)return Cz("PES is undefined"),O.return();x=e.videoId;return g.I(O,wZ(C,g.rt(x,"mainVideoEntity"),"mainVideoEntity"),3)}Y=O.C;if(!Y)return O.return();B=Math.floor(d).toString();q={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:B}};return g.I(O,E.Z$([x],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
q),0)})};
g.D.isOrchestrationLeader=function(){return this.C.isOrchestrationLeader()};
g.D.updateDownloadState=function(l,E){var e,d,C,x;return g.P(function(Y){if(Y.V==1)return g.I(Y,l6(),2);e=Y.C;if(!e)return Cz("PES is undefined"),Y.return();d=g.z6(l);C=d.entityType;x=d.entityId;return g.I(Y,J6(x,C,e,E,!0),0)})};g.HQ("offline",vDx);})(_yt_player);
